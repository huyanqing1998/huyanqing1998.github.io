<!DOCTYPE html>
<html lang='zh-CN'>

<head>
  <meta name="generator" content="Hexo 6.1.0">
  <meta charset="utf-8">
  

  <meta http-equiv='x-dns-prefetch-control' content='on' />
  <link rel='dns-prefetch' href='https://cdn.jsdelivr.net'>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel='dns-prefetch' href='//unpkg.com'>

  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  <title>第52次课程-S1_WebTimeMachina - Hooy's Blog</title>

  

  
    <meta name="description" content="源辰74班 第52次课程 08.01.2019-08.11.2019 内容 S1项目 WebTimeMachina 项目组成员：胡燕卿 容创伟 肖理达 邵子芸 项目效果图： ** ** ** ** ** ** ** ** ** ** 项目简介： 本项目核心为网页爬虫，获取目标网页数据并保存于本地。 项目源码： WTMwindow 1234567891011121314151617181920212">
<meta property="og:type" content="article">
<meta property="og:title" content="第52次课程-S1_WebTimeMachina">
<meta property="og:url" content="http://blog.hooy.xyz/%E6%8A%80%E6%9C%AF%E5%90%91/Java/%E6%BA%90%E8%BE%B0%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95/%E7%AC%AC52%E6%AC%A1%E8%AF%BE%E7%A8%8B-S1_WebTimeMachina/index.html">
<meta property="og:site_name" content="Hooy&#39;s Blog">
<meta property="og:description" content="源辰74班 第52次课程 08.01.2019-08.11.2019 内容 S1项目 WebTimeMachina 项目组成员：胡燕卿 容创伟 肖理达 邵子芸 项目效果图： ** ** ** ** ** ** ** ** ** ** 项目简介： 本项目核心为网页爬虫，获取目标网页数据并保存于本地。 项目源码： WTMwindow 1234567891011121314151617181920212">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://blog.hooy.xyz/image/9ad6efaa1c6239e05bfa6e94844dcd31.png">
<meta property="og:image" content="http://blog.hooy.xyz/image/d3334964e9b85217ce14b92f05d7da7f.png">
<meta property="og:image" content="http://blog.hooy.xyz/image/b07b0b86f3f9aeeb0fdb08e35d225069.png">
<meta property="og:image" content="http://blog.hooy.xyz/image/9822ec9930f0a138b6b6fd3c4ecb559c.png">
<meta property="og:image" content="http://blog.hooy.xyz/image/41a20b382d3081bc14436eea2f8e0f68.png">
<meta property="article:published_time" content="2019-07-31T16:00:00.000Z">
<meta property="article:modified_time" content="2022-05-11T01:19:00.351Z">
<meta property="article:author" content="Hooyantsing">
<meta property="article:tag" content="源辰">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://blog.hooy.xyz/image/9ad6efaa1c6239e05bfa6e94844dcd31.png">
  
  

  <!-- feed -->
  
    <link rel="alternate" href="/atom.xml" title="Hooy's Blog" type="application/atom+xml">
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  

  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='post'>
    


<header class="header">

<div class="logo-wrap"><a class="title" href="/"><div class="main">Hooy's Blog</div></a></div>
<nav class="menu dis-select"></nav></header>

<div class="widgets">


<div class="widget-wrap" id="recent"><div class="widget-header cap dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><div class="more-item"><a class="title" href="/%E6%8A%80%E6%9C%AF%E5%90%91/SpringCloud/%E5%B0%8F%E7%A0%B4%E7%AB%99%E8%AE%B2%E7%9A%84%E6%9C%80%E5%A5%BDSpringCloudAlibaba%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B_%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B%E9%80%9A%E4%BF%97%E6%98%93%E6%87%82/P26%20%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%B0%83%E7%94%A8%E7%BB%84%E4%BB%B6%20Feign/">P26 微服务调用组件 Feign</a></div><div class="more-item"><a class="title" href="/%E6%8A%80%E6%9C%AF%E5%90%91/SpringCloud/%E5%B0%8F%E7%A0%B4%E7%AB%99%E8%AE%B2%E7%9A%84%E6%9C%80%E5%A5%BDSpringCloudAlibaba%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B_%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B%E9%80%9A%E4%BF%97%E6%98%93%E6%87%82/P25%20%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8%20LoadBalancer/">P25 微服务负载均衡器 LoadBalancer</a></div><div class="more-item"><a class="title" href="/%E6%8A%80%E6%9C%AF%E5%90%91/SpringCloud/%E5%B0%8F%E7%A0%B4%E7%AB%99%E8%AE%B2%E7%9A%84%E6%9C%80%E5%A5%BDSpringCloudAlibaba%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B_%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B%E9%80%9A%E4%BF%97%E6%98%93%E6%87%82/P21%20%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E5%99%A8%20Ribbon/">P21 微服务负载均衡器 Ribbon</a></div><div class="more-item"><a class="title" href="/%E6%8A%80%E6%9C%AF%E5%90%91/SpringCloud/%E5%B0%8F%E7%A0%B4%E7%AB%99%E8%AE%B2%E7%9A%84%E6%9C%80%E5%A5%BDSpringCloudAlibaba%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B_%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B%E9%80%9A%E4%BF%97%E6%98%93%E6%87%82/P12%20Alibaba%20%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%BB%84%E4%BB%B6%20Nacos%20%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83/">P12 Alibaba 微服务组件 Nacos 注册中心</a></div><div class="more-item"><a class="title" href="/%E6%8A%80%E6%9C%AF%E5%90%91/SpringCloud/%E5%B0%8F%E7%A0%B4%E7%AB%99%E8%AE%B2%E7%9A%84%E6%9C%80%E5%A5%BDSpringCloudAlibaba%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B_%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B%E9%80%9A%E4%BF%97%E6%98%93%E6%87%82/P01%20%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%92%8C%20Spring%20Cloud%20Alibaba/">P01 微服务和 Spring Cloud Alibaba</a></div></div></div>



</div>


    </aside>
    <div class='l_main'>
      

      

<div class="bread-nav fs12"><div id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" href="/">文章</a><span class="sep"></span><a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%90%91/">技术向</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%90%91/Java/">Java</a> <span class="sep"></span> <a class="cap breadcrumb-link" href="/categories/%E6%8A%80%E6%9C%AF%E5%90%91/Java/%E6%BA%90%E8%BE%B0%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95/">源辰课程记录</a></div><div id="post-meta">发布于&nbsp;<time datetime="2019-07-31T16:00:00.000Z">2019-08-01</time></div></div>

<article class='content md post'>
<h1 class="article-title"><span>第52次课程-S1_WebTimeMachina</span></h1>
<p><strong>源辰74班</strong></p>
<p><strong>第52次课程</strong></p>
<p><strong>08.01.2019-08.11.2019</strong></p>
<p><strong>内容</strong></p>
<p><strong>S1项目</strong></p>
<p><strong>WebTimeMachina</strong></p>
<p><strong>项目组成员：胡燕卿 容创伟 肖理达 邵子芸</strong></p>
<p><strong>项目效果图：</strong></p>
<p>**<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/image/9ad6efaa1c6239e05bfa6e94844dcd31.png" alt="9ad6efaa1c6239e05bfa6e94844dcd31.png"></p>
<p>**</p>
<p>**<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/image/d3334964e9b85217ce14b92f05d7da7f.png" alt="d3334964e9b85217ce14b92f05d7da7f.png"></p>
<p>**</p>
<p>**<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/image/b07b0b86f3f9aeeb0fdb08e35d225069.png" alt="b07b0b86f3f9aeeb0fdb08e35d225069.png"></p>
<p>**</p>
<p>**<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/image/9822ec9930f0a138b6b6fd3c4ecb559c.png" alt="9822ec9930f0a138b6b6fd3c4ecb559c.png"></p>
<p>**</p>
<p>**<img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/image/41a20b382d3081bc14436eea2f8e0f68.png" alt="41a20b382d3081bc14436eea2f8e0f68.png"></p>
<p>**</p>
<p><strong>项目简介：</strong></p>
<p><strong>本项目核心为网页爬虫，获取目标网页数据并保存于本地。</strong></p>
<p><strong>项目源码：</strong></p>
<p><strong>WTMwindow</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Spinner;</span><br><span class="line">import org.eclipse.swt.widgets.Menu;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.sql.Date;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.sql.SQLSyntaxErrorException;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.LinkedHashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.MenuItem;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line">import org.eclipse.swt.widgets.TabFolder;</span><br><span class="line">import org.eclipse.swt.widgets.TabItem;</span><br><span class="line">import org.eclipse.swt.widgets.Composite;</span><br><span class="line">import org.eclipse.swt.widgets.DateTime;</span><br><span class="line">import org.eclipse.swt.widgets.DirectoryDialog;</span><br><span class="line">import org.eclipse.swt.widgets.Table;</span><br><span class="line">import org.eclipse.swt.widgets.TableColumn;</span><br><span class="line">import org.eclipse.swt.widgets.TableItem;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.widgets.Combo;</span><br><span class="line">import org.eclipse.swt.events.MenuDetectEvent;</span><br><span class="line">import org.eclipse.swt.events.MenuDetectListener;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.swt.events.ShellAdapter;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Tray;</span><br><span class="line">import org.eclipse.swt.widgets.TrayItem;</span><br><span class="line">import org.eclipse.swt.events.ShellEvent;</span><br><span class="line"></span><br><span class="line">public class WTMwindow &#123;</span><br><span class="line"></span><br><span class="line">    protected Shell shellwindow;</span><br><span class="line">    private Table table;</span><br><span class="line">    private Text settaskname;</span><br><span class="line">    private Text settaskresultfile;</span><br><span class="line">    private Text settaskurlstr;</span><br><span class="line">    private Text SQLoption;</span><br><span class="line">    private Text text_6;</span><br><span class="line">    private Text timerhour;</span><br><span class="line">    private Text timerminute;</span><br><span class="line">    private Text text;</span><br><span class="line">    private Text text_1;// 网站名输入框 肖理达</span><br><span class="line">    private Table table_1;// 爬取记录表 肖理达</span><br><span class="line">    private Text text_2;// URL输入框 肖理达</span><br><span class="line">    private Text text_3;// 任务编号记录框 肖理达</span><br><span class="line">    private DateTime dateTime;// 时间下限 肖理达</span><br><span class="line">    private DateTime dateTime_1;// 时间上限 肖理达</span><br><span class="line">    private Combo combo;// 爬取状态下拉框 肖理达</span><br><span class="line">    private Button button_12;// 时间下限勾选框 肖理达</span><br><span class="line">    private Button button_13;// 时间上限勾选框 肖理达</span><br><span class="line">    private Spinner spinner;// 页码显示器</span><br><span class="line">    private Label countrec;// 记录计数器 肖理达</span><br><span class="line">    private int recPage = 1; // 当前记录页数,默认第一页 肖理达</span><br><span class="line">    private int countRec;// 查询记录总数 肖理达</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Launch the application.</span><br><span class="line">     *</span><br><span class="line">     * @param args</span><br><span class="line">     */</span><br><span class="line">    public static void main(String[] arg) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            WTMwindow window = new WTMwindow();</span><br><span class="line">            window.open();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the window.</span><br><span class="line">     */</span><br><span class="line">    Display display = Display.getDefault();</span><br><span class="line"></span><br><span class="line">    public void open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        // 居中显示</span><br><span class="line">        int x = (display.getBounds().width - shellwindow.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shellwindow.getBounds().height) / 2;</span><br><span class="line">        shellwindow.setLocation(x, y);</span><br><span class="line">        shellwindow.open();</span><br><span class="line">        shellwindow.layout();</span><br><span class="line">        while (!shellwindow.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the window.</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    protected void createContents() &#123;</span><br><span class="line">        shellwindow = new Shell(SWT.CLOSE | SWT.MIN);</span><br><span class="line">        shellwindow.setSize(800, 450);</span><br><span class="line">        shellwindow.setText(&quot;WebTimeMachine 3.2&quot;);</span><br><span class="line"></span><br><span class="line">        Menu menu = new Menu(shellwindow, SWT.BAR);</span><br><span class="line">        shellwindow.setMenuBar(menu);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem = new MenuItem(menu, SWT.CASCADE);</span><br><span class="line">        menuItem.setText(&quot;\u7CFB\u7EDF&quot;);</span><br><span class="line"></span><br><span class="line">        Menu menu_1 = new Menu(menuItem);</span><br><span class="line">        menuItem.setMenu(menu_1);</span><br><span class="line"></span><br><span class="line">        /*</span><br><span class="line">         * MenuItem menuItem_3 = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">         * menuItem_3.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">         *</span><br><span class="line">         * @Override public void widgetSelected(SelectionEvent e) &#123; try &#123; //打开应用路径</span><br><span class="line">         * 打开配置文件路径 String str =</span><br><span class="line">         * &quot;C:\\WINDOWS\\system32\\notepad.exe G:\\WebTimeMachine\\Java\\src\\db.properties&quot;</span><br><span class="line">         * ; Runtime.getRuntime().exec(str); &#125; catch (IOException | NullPointerException</span><br><span class="line">         * e2) &#123; MessageBox mb = new MessageBox(shellwindow,SWT.ICON_ERROR |</span><br><span class="line">         * SWT.OK); mb.setText(&quot;配置文件遇到异常&quot;); mb.setMessage(e2.getMessage()); mb.open(); &#125;</span><br><span class="line">         *</span><br><span class="line">         * &#125; &#125;); menuItem_3.setText(&quot;\u914D\u7F6E\u6587\u4EF6&quot;);</span><br><span class="line">         */</span><br><span class="line">        </span><br><span class="line">        MenuItem menuItem_7 = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">        menuItem_7.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                DirectoryDialog dd=new DirectoryDialog(shellwindow);</span><br><span class="line">                dd.setText(&quot;目录浏览&quot;);  </span><br><span class="line">                dd.setMessage(&quot;请选择库目录所在位置&quot;);  </span><br><span class="line">                //dd.setFilterPath(&quot;C:\\&quot;);  </span><br><span class="line">                String locationPath = dd.open();  </span><br><span class="line">                if(locationPath!=null)&#123;                </span><br><span class="line">                    Runtime rt = Runtime.getRuntime();</span><br><span class="line">                    try &#123;</span><br><span class="line">                        rt.exec(&quot;explorer.exe &quot; + locationPath);</span><br><span class="line">                    &#125; catch (IOException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-0214  库目录获取错误&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();    </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_7.setText(&quot;\u5E93\u76EE\u5F55&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem mntmDmp = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">        mntmDmp.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                new OracleFileOut(shellwindow, countRec).open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        mntmDmp.setText(&quot;DMP\u6587\u4EF6\u5BFC\u51FA&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem mntmDmp_1 = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">        mntmDmp_1.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                new OracleFileIn(shellwindow, countRec).open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        mntmDmp_1.setText(&quot;DMP\u6587\u4EF6\u5BFC\u5165&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_4 = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">        menuItem_4.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                System.exit(0);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_4.setText(&quot;\u5B89\u5168\u9000\u51FA&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_8 = new MenuItem(menu, SWT.CASCADE);</span><br><span class="line">        menuItem_8.setText(&quot;\u4E2A\u4EBA&quot;);</span><br><span class="line"></span><br><span class="line">        Menu menu_4 = new Menu(menuItem_8);</span><br><span class="line">        menuItem_8.setMenu(menu_4);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_3 = new MenuItem(menu_4, SWT.NONE);</span><br><span class="line">        menuItem_3.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                new PersonalCenter(shellwindow, SWT.NONE).open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_3.setText(&quot;\u4E2A\u4EBA\u4E2D\u5FC3&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_1 = new MenuItem(menu, SWT.CASCADE);</span><br><span class="line">        menuItem_1.setText(&quot;\u5E2E\u52A9&quot;);</span><br><span class="line"></span><br><span class="line">        Menu menu_2 = new Menu(menuItem_1);</span><br><span class="line">        menuItem_1.setMenu(menu_2);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_6 = new MenuItem(menu_2, SWT.NONE);</span><br><span class="line">        menuItem_6.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                HelpFile helpfile = new HelpFile(shellwindow, SWT.NONE);</span><br><span class="line">                helpfile.open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_6.setText(&quot;\u4F7F\u7528\u6587\u6863&quot;);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_2 = new MenuItem(menu, SWT.CASCADE);</span><br><span class="line"></span><br><span class="line">        menuItem_2.setText(&quot;\u5173\u4E8E&quot;);</span><br><span class="line"></span><br><span class="line">        Menu menu_3 = new Menu(menuItem_2);</span><br><span class="line">        menuItem_2.setMenu(menu_3);</span><br><span class="line"></span><br><span class="line">        MenuItem menuItem_5 = new MenuItem(menu_3, SWT.NONE);</span><br><span class="line">        menuItem_5.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                About about = new About(shellwindow, SWT.NONE);</span><br><span class="line">                about.open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_5.setText(&quot;\u7248\u672C&quot;);</span><br><span class="line"></span><br><span class="line">        TabFolder tabFolder = new TabFolder(shellwindow, SWT.NONE);</span><br><span class="line">        tabFolder.setBounds(0, 0, 794, 401);</span><br><span class="line"></span><br><span class="line">        TabItem tabItem = new TabItem(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem.setText(&quot;\u4EFB\u52A1\u8868&quot;);</span><br><span class="line"></span><br><span class="line">        Composite composite = new Composite(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem.setControl(composite);</span><br><span class="line"></span><br><span class="line">        table = new Table(composite, SWT.BORDER | SWT.FULL_SELECTION);</span><br><span class="line">        table.setBounds(10, 10, 649, 351);</span><br><span class="line">        table.setHeaderVisible(true);</span><br><span class="line">        table.setLinesVisible(true);</span><br><span class="line"></span><br><span class="line">        TableColumn tableColumn = new TableColumn(table, SWT.NONE);</span><br><span class="line">        tableColumn.setWidth(80);</span><br><span class="line">        tableColumn.setText(&quot;\u7F16\u53F7&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tableColumn_1 = new TableColumn(table, SWT.NONE);</span><br><span class="line">        tableColumn_1.setWidth(130);</span><br><span class="line">        tableColumn_1.setText(&quot;\u540D\u79F0&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tableColumn_2 = new TableColumn(table, SWT.NONE);</span><br><span class="line">        tableColumn_2.setWidth(180);</span><br><span class="line">        tableColumn_2.setText(&quot;\u8DEF\u5F84&quot;);</span><br><span class="line"></span><br><span class="line">        // TableColumn tableColumn_3 = new TableColumn(table, SWT.NONE);</span><br><span class="line">        // tableColumn_3.setWidth(130);</span><br><span class="line">        // tableColumn_3.setText(&quot;\u7F13\u5B58\u8DEF\u5F84&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnUrl = new TableColumn(table, SWT.NONE);</span><br><span class="line">        tblclmnUrl.setWidth(255);</span><br><span class="line">        tblclmnUrl.setText(&quot;Url&quot;);</span><br><span class="line"></span><br><span class="line">        Button button = new Button(composite, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                String sql = &quot; select * from tasksheet where 1=1 &quot;;</span><br><span class="line">                List&lt;String&gt; paramList = new ArrayList&lt;&gt;();</span><br><span class="line">                if (text.getText().trim().length() &gt; 0) &#123;</span><br><span class="line">                    sql += &quot; and TASKNAME like ? &quot;;</span><br><span class="line">                    paramList.add(&quot;%&quot; + text.getText() + &quot;%&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">                try &#123;</span><br><span class="line">                    table.removeAll();</span><br><span class="line">                    List&lt;Map&lt;String, Object&gt;&gt; ret = WTMbackstage.query(sql, paramList.toArray());</span><br><span class="line">                    for (Map&lt;String, Object&gt; row : ret) &#123;</span><br><span class="line">                        TableItem tableItem = new TableItem(table, SWT.NONE);</span><br><span class="line">                        tableItem.setText(new String[] &#123; row.get(&quot;TASKID&quot;) + &quot;&quot;, // 避免空表格</span><br><span class="line">                                row.get(&quot;TASKNAME&quot;) + &quot;&quot;, row.get(&quot;TASKRESULTFILE&quot;) + &quot;&quot;,</span><br><span class="line">                                // row.get(&quot;TASKCACHEFILE&quot;)+&quot;&quot;,</span><br><span class="line">                                row.get(&quot;TASKURLSTR&quot;) + &quot;&quot; &#125;);</span><br><span class="line">                        tableItem.setData(row);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (SQLException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0201  获取数据失败&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        button.setBounds(684, 74, 80, 27);</span><br><span class="line">        button.setText(&quot;\u67E5\u8BE2&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_1 = new Button(composite, SWT.NONE);</span><br><span class="line">        button_1.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (table.getSelectionCount() &gt; 0) &#123;</span><br><span class="line">                    TableItem[] items = table.getSelection();</span><br><span class="line">                    TableItem item = items[0];</span><br><span class="line">                    @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">                    Map&lt;String, Object&gt; row = (Map&lt;String, Object&gt;) item.getData();</span><br><span class="line">                    String flag = &quot;false&quot;;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        flag = Reptile6.Init(row.get(&quot;TASKNAME&quot;) + &quot;&quot;, row.get(&quot;TASKRESULTFILE&quot;) + &quot;&quot;,</span><br><span class="line">                                row.get(&quot;TASKURLSTR&quot;) + &quot;&quot;);</span><br><span class="line">                        Map&lt;String, Object&gt; result = new LinkedHashMap&lt;&gt;();</span><br><span class="line">                        result.put(&quot;MARK&quot;, flag);</span><br><span class="line">                        result.put(&quot;TASKID&quot;, row.get(&quot;TASKID&quot;));</span><br><span class="line">                        result.put(&quot;TASKNAME&quot;, row.get(&quot;TASKNAME&quot;));</span><br><span class="line">                        result.put(&quot;TASKRESULTFILE&quot;, row.get(&quot;TASKRESULTFILE&quot;));</span><br><span class="line">                        result.put(&quot;TASKURLSTR&quot;, row.get(&quot;TASKURLSTR&quot;));</span><br><span class="line">                        // 调用 肖理达方法(result);</span><br><span class="line">                        RecordBackstage.addRecord(result);</span><br><span class="line"></span><br><span class="line">                    &#125; catch (Exception e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-0202  获取数据失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if (flag.equals(&quot;true&quot;)) &#123;</span><br><span class="line">                        MessageBox mb1 = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                        mb1.setText(&quot;系统提示&quot;);</span><br><span class="line">                        mb1.setMessage(&quot;数据爬取成功：1条&quot;);</span><br><span class="line">                        mb1.open();</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        MessageBox mb2 = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb2.setText(&quot;WTM-0203  爬取数据失败&quot;);</span><br><span class="line">                        mb2.setMessage(&quot;爬取数据失败：1条&quot;);</span><br><span class="line">                        mb2.open();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0204  请选中爬取对象&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请选中爬取对象&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_1.setBounds(684, 278, 80, 27);</span><br><span class="line">        button_1.setText(&quot;\u7ACB\u5373\u6267\u884C&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_7 = new Button(composite, SWT.NONE);</span><br><span class="line">        button_7.setBounds(684, 145, 80, 27);</span><br><span class="line">        button_7.setText(&quot;\u65B0\u589E&quot;);</span><br><span class="line"></span><br><span class="line">        Button delete = new Button(composite, SWT.NONE);</span><br><span class="line">        delete.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (table.getSelectionCount() &gt; 0) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        TableItem[] items = table.getSelection();</span><br><span class="line">                        TableItem item = items[0];</span><br><span class="line">                        @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">                        Map&lt;String, Object&gt; row = (Map&lt;String, Object&gt;) item.getData();</span><br><span class="line">                        String sql = &quot; delete from tasksheet where taskid = ? &quot;;</span><br><span class="line">                        WTMbackstage.update(sql, row.get(&quot;TASKID&quot;));</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;系统提示&quot;);</span><br><span class="line">                        mb.setMessage(&quot;删除任务成功&quot;);</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (SQLException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-0205  删除任务失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0206  请选中删除对象&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请选中删除对象&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        delete.setBounds(684, 211, 80, 27);</span><br><span class="line">        delete.setText(&quot;\u5220\u9664&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_9 = new Button(composite, SWT.NONE);</span><br><span class="line">        button_9.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (table.getSelectionCount() &gt; 0) &#123;</span><br><span class="line">                    TableItem[] items = table.getSelection();</span><br><span class="line">                    TableItem item = items[0];</span><br><span class="line">                    @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">                    Map&lt;String, Object&gt; row = (Map&lt;String, Object&gt;) item.getData();</span><br><span class="line">                    new Modify(shellwindow, SWT.NONE, row).open();</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0207  请选中修改对象&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请选中修改对象&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_9.setBounds(684, 178, 80, 27);</span><br><span class="line">        button_9.setText(&quot;\u4FEE\u6539&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_10 = new Button(composite, SWT.NONE);</span><br><span class="line">        button_10.setBounds(684, 311, 80, 27);</span><br><span class="line">        button_10.setText(&quot;\u5B9A\u65F6\u6267\u884C&quot;);</span><br><span class="line"></span><br><span class="line">        text = new Text(composite, SWT.BORDER);</span><br><span class="line">        text.setBounds(684, 45, 80, 23);</span><br><span class="line"></span><br><span class="line">        Label label_14 = new Label(composite, SWT.NONE);</span><br><span class="line">        label_14.setBounds(711, 22, 24, 17);</span><br><span class="line">        label_14.setText(&quot;\u540D\u79F0&quot;);</span><br><span class="line"></span><br><span class="line">        TabItem tabItem_2 = new TabItem(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_2.setText(&quot;\u4EFB\u52A1\u8BA1\u5212&quot;);</span><br><span class="line"></span><br><span class="line">        Composite composite_2 = new Composite(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_2.setControl(composite_2);</span><br><span class="line"></span><br><span class="line">        Label lblNewLabel = new Label(composite_2, SWT.NONE);</span><br><span class="line">        lblNewLabel.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 12, SWT.NORMAL));</span><br><span class="line">        lblNewLabel.setBounds(10, 24, 64, 21);</span><br><span class="line">        lblNewLabel.setText(&quot;\u6DFB\u52A0\u8BB0\u5F55&quot;);</span><br><span class="line"></span><br><span class="line">        Label label = new Label(composite_2, SWT.NONE);</span><br><span class="line">        label.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 9, SWT.NORMAL));</span><br><span class="line">        label.setBounds(80, 47, 24, 17);</span><br><span class="line">        label.setText(&quot;\u540D\u79F0&quot;);</span><br><span class="line"></span><br><span class="line">        settaskname = new Text(composite_2, SWT.BORDER);</span><br><span class="line">        settaskname.setBounds(137, 44, 250, 23);</span><br><span class="line"></span><br><span class="line">        Label label_1 = new Label(composite_2, SWT.NONE);</span><br><span class="line">        label_1.setBounds(80, 74, 48, 17);</span><br><span class="line">        label_1.setText(&quot;\u8DEF\u5F84&quot;);</span><br><span class="line"></span><br><span class="line">        settaskresultfile = new Text(composite_2, SWT.BORDER);</span><br><span class="line">        settaskresultfile.setBounds(137, 71, 250, 23);</span><br><span class="line"></span><br><span class="line">        Label label_3 = new Label(composite_2, SWT.NONE);</span><br><span class="line">        label_3.setBounds(80, 103, 36, 17);</span><br><span class="line">        label_3.setText(&quot;\u6E90\u7F51\u5740&quot;);</span><br><span class="line"></span><br><span class="line">        settaskurlstr = new Text(composite_2, SWT.BORDER);</span><br><span class="line">        settaskurlstr.setBounds(137, 100, 500, 23);</span><br><span class="line"></span><br><span class="line">        Button button_2 = new Button(composite_2, SWT.NONE);</span><br><span class="line">        button_2.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (settaskname.getText().trim().length() &gt; 0 &amp;&amp; settaskresultfile.getText().trim().length() &gt; 0</span><br><span class="line">                        &amp;&amp; settaskurlstr.getText().length() &gt; 0) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        WTMbackstage.insertTask(settaskname.getText(), settaskresultfile.getText(), null,</span><br><span class="line">                                settaskurlstr.getText());</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;系统提示&quot;);</span><br><span class="line">                        mb.setMessage(&quot;添加任务成功&quot;);</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (SQLException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-0208  添加任务失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0213  添加任务失败&quot;);</span><br><span class="line">                    mb.setMessage(&quot;文本框不能为空&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_2.setBounds(137, 129, 80, 27);</span><br><span class="line">        button_2.setText(&quot;\u786E\u8BA4\u6DFB\u52A0&quot;);</span><br><span class="line"></span><br><span class="line">        Label lblOracle = new Label(composite_2, SWT.NONE);</span><br><span class="line">        lblOracle.setText(&quot;Oracle\u63A7\u5236\u53F0&quot;);</span><br><span class="line">        lblOracle.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 12, SWT.NORMAL));</span><br><span class="line">        lblOracle.setBounds(10, 244, 106, 21);</span><br><span class="line"></span><br><span class="line">        Label label_6 = new Label(composite_2, SWT.NONE);</span><br><span class="line">        label_6.setBounds(80, 273, 24, 17);</span><br><span class="line">        label_6.setText(&quot;\u6307\u4EE4&quot;);</span><br><span class="line"></span><br><span class="line">        SQLoption = new Text(composite_2, SWT.BORDER);</span><br><span class="line">        SQLoption.setBounds(137, 270, 500, 23);</span><br><span class="line"></span><br><span class="line">        /*</span><br><span class="line">         * Button button_3 = new Button(composite_2, SWT.NONE);</span><br><span class="line">         * button_3.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">         *</span><br><span class="line">         * @Override public void widgetSelected(SelectionEvent e) &#123; try &#123;</span><br><span class="line">         * WTMbackstage.deleteTask(Integer.parseInt(deletetask.getText())); MessageBox</span><br><span class="line">         * mb = new MessageBox(shellwindow,SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">         * mb.setText(&quot;表记录删除成功&quot;); mb.setMessage(&quot;表记录删除成功&quot;); mb.open(); &#125; catch</span><br><span class="line">         * (SQLException e1) &#123; MessageBox mb = new</span><br><span class="line">         * MessageBox(shellwindow,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">         * System.out.println(e1); mb.setText(&quot;表记录删除失败&quot;);</span><br><span class="line">         * mb.setMessage(e1.getMessage()); mb.open(); &#125; &#125; &#125;);</span><br><span class="line">         * button_3.setText(&quot;\u786E\u8BA4\u5220\u9664&quot;); button_3.setBounds(137, 232,</span><br><span class="line">         * 80, 27);</span><br><span class="line">         */</span><br><span class="line"></span><br><span class="line">        Button button_4 = new Button(composite_2, SWT.NONE);</span><br><span class="line">        button_4.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    WTMbackstage.SQLOption(SQLoption.getText());</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);;</span><br><span class="line">                    mb.setText(&quot;系统提示 指令发送成功&quot;);</span><br><span class="line">                    mb.setMessage(&quot;指令发送成功：&quot; + SQLoption.getText());</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125; catch (SQLException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    System.out.println(e1);</span><br><span class="line">                    mb.setText(&quot;WTM-0209  数据库遇到错误&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_4.setText(&quot;\u53D1\u9001&quot;);</span><br><span class="line">        button_4.setBounds(137, 299, 80, 27);</span><br><span class="line"></span><br><span class="line">        Label label_8 = new Label(composite_2, SWT.SEPARATOR | SWT.HORIZONTAL);</span><br><span class="line">        label_8.setBounds(10, 205, 766, 2);</span><br><span class="line"></span><br><span class="line">        Button button_3 = new Button(composite_2, SWT.NONE);</span><br><span class="line">        button_3.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                settaskname.setText(&quot;&quot;);</span><br><span class="line">                settaskurlstr.setText(&quot;&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_3.setBounds(223, 129, 80, 27);</span><br><span class="line">        button_3.setText(&quot;\u91CD\u7F6E&quot;);</span><br><span class="line">        </span><br><span class="line">        Button btnNewButton = new Button(composite_2, SWT.NONE);</span><br><span class="line">        btnNewButton.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                DirectoryDialog dd=new DirectoryDialog(shellwindow);</span><br><span class="line">                dd.setText(&quot;目录浏览&quot;);  </span><br><span class="line">                dd.setMessage(&quot;请选择库目录所在位置&quot;);  </span><br><span class="line">                dd.setFilterPath(&quot;C:\\&quot;);  </span><br><span class="line">                String locationPath = dd.open();  </span><br><span class="line">                if(locationPath!=null)&#123;                </span><br><span class="line">                    settaskresultfile.setText(locationPath);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btnNewButton.setBounds(400, 71, 60, 23);</span><br><span class="line">        btnNewButton.setText(&quot;\u6D4F\u89C8&quot;);</span><br><span class="line"></span><br><span class="line">        TabItem tabItem_3 = new TabItem(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_3.setText(&quot;\u5B9A\u65F6\u4EFB\u52A1&quot;);</span><br><span class="line"></span><br><span class="line">        Composite composite_3 = new Composite(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_3.setControl(composite_3);</span><br><span class="line"></span><br><span class="line">        Label label_9 = new Label(composite_3, SWT.NONE);</span><br><span class="line">        label_9.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 10, SWT.NORMAL));</span><br><span class="line">        label_9.setBounds(10, 10, 282, 19);</span><br><span class="line">        label_9.setText(</span><br><span class="line">                &quot;\u8B66\u544A\uFF1A\u5373\u65F6\u542F\u52A8\u8BF7\u5728\u5F53\u524D\u65F6\u95F4\u57FA\u7840\u4E0A\u540E\u5EF6\u4E00\u5206\u949F&quot;);</span><br><span class="line"></span><br><span class="line">        Label lblNewLabel_1 = new Label(composite_3, SWT.NONE);</span><br><span class="line">        lblNewLabel_1.setBounds(49, 58, 61, 17);</span><br><span class="line">        lblNewLabel_1.setText(&quot;\u542F\u52A8\u65F6\u95F4\uFF1A&quot;);</span><br><span class="line"></span><br><span class="line">        Label label_10 = new Label(composite_3, SWT.SEPARATOR | SWT.HORIZONTAL);</span><br><span class="line">        label_10.setBounds(10, 35, 756, 2);</span><br><span class="line"></span><br><span class="line">        text_6 = new Text(composite_3, SWT.BORDER);</span><br><span class="line">        text_6.setEnabled(false);</span><br><span class="line">        text_6.setText(&quot;\u5F53\u5929&quot;);</span><br><span class="line">        text_6.setBounds(117, 55, 73, 23);</span><br><span class="line"></span><br><span class="line">        Label label_11 = new Label(composite_3, SWT.NONE);</span><br><span class="line">        label_11.setBounds(196, 58, 12, 17);</span><br><span class="line">        label_11.setText(&quot;\u65E5&quot;);</span><br><span class="line"></span><br><span class="line">        timerhour = new Text(composite_3, SWT.BORDER);</span><br><span class="line">        timerhour.setText(&quot;23&quot;);</span><br><span class="line">        timerhour.setBounds(214, 55, 73, 23);</span><br><span class="line"></span><br><span class="line">        Label label_12 = new Label(composite_3, SWT.NONE);</span><br><span class="line">        label_12.setBounds(293, 58, 12, 17);</span><br><span class="line">        label_12.setText(&quot;\u65F6&quot;);</span><br><span class="line"></span><br><span class="line">        timerminute = new Text(composite_3, SWT.BORDER);</span><br><span class="line">        timerminute.setText(&quot;59&quot;);</span><br><span class="line">        timerminute.setBounds(311, 55, 73, 23);</span><br><span class="line"></span><br><span class="line">        Label label_13 = new Label(composite_3, SWT.NONE);</span><br><span class="line">        label_13.setBounds(390, 58, 61, 17);</span><br><span class="line">        label_13.setText(&quot;\u5206&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_5 = new Button(composite_3, SWT.NONE);</span><br><span class="line">        button_5.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                WTMbackstage.spiderTimer(Integer.parseInt(timerhour.getText()),</span><br><span class="line">                        Integer.parseInt(timerminute.getText()));</span><br><span class="line">                MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                mb.setText(&quot;已启动定时器&quot;);</span><br><span class="line">                mb.setMessage(&quot;每天&quot; + timerhour.getText() + &quot;时&quot; + timerminute.getText() + &quot;分将自动运行&quot;);</span><br><span class="line">                mb.open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_5.setBounds(117, 100, 80, 27);</span><br><span class="line">        button_5.setText(&quot;\u5B9A\u65F6\u542F\u52A8&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_6 = new Button(composite_3, SWT.NONE);</span><br><span class="line">        button_6.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                WTMbackstage.spiderTimerStop();</span><br><span class="line">                MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                mb.setText(&quot;已停止定时器&quot;);</span><br><span class="line">                mb.setMessage(&quot;定时器已经安全解除&quot;);</span><br><span class="line">                mb.open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_6.setBounds(214, 100, 80, 27);</span><br><span class="line">        button_6.setText(&quot;\u505C\u6B62&quot;);</span><br><span class="line"></span><br><span class="line">        TabItem tabItem_1 = new TabItem(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_1.setText(&quot;\u722C\u53D6\u8BB0\u5F55&quot;);</span><br><span class="line"></span><br><span class="line">        Composite composite_1 = new Composite(tabFolder, SWT.NONE);</span><br><span class="line">        tabItem_1.setControl(composite_1);</span><br><span class="line"></span><br><span class="line">        button_7.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                tabFolder.setSelection(tabItem_2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        button_10.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                tabFolder.setSelection(tabItem_3);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 容创伟 图标</span><br><span class="line">        // Image image = new Image(display,&quot;G:\\WebTimeMachine\\img\\图标.ico&quot;);</span><br><span class="line">        // 容创伟 最小化托盘</span><br><span class="line">        shellwindow.setImage(SWTResourceManager.getImage(WTMwindow.class, &quot;/img/\u56FE\u6807.ico&quot;));</span><br><span class="line">        final Tray tray = display.getSystemTray();</span><br><span class="line">        final TrayItem trayItem = new TrayItem(tray, SWT.NONE);</span><br><span class="line">        trayItem.setImage(SWTResourceManager.getImage(WTMwindow.class, &quot;/img/\u56FE\u6807.ico&quot;));</span><br><span class="line">        trayItem.setVisible(false);</span><br><span class="line">        trayItem.setToolTipText(&quot;WebTimeMachine 2.8&quot;);</span><br><span class="line">        trayItem.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                toggleDisplay(shellwindow, tray);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        shellwindow.addShellListener(new ShellAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void shellIconified(ShellEvent e) &#123;</span><br><span class="line">                toggleDisplay(shellwindow, tray);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void shellClosed(ShellEvent e) &#123;</span><br><span class="line">                trayItem.dispose();</span><br><span class="line">                System.exit(0);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        final Menu trayMenu = new Menu(shellwindow, SWT.POP_UP);</span><br><span class="line">        MenuItem showMenuItem = new MenuItem(trayMenu, SWT.PUSH);</span><br><span class="line">        showMenuItem.setText(&quot;显示窗口&quot;);</span><br><span class="line">        // 显示窗口，并隐藏托盘图标</span><br><span class="line">        showMenuItem.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                toggleDisplay(shellwindow, tray);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        trayMenu.setDefaultItem(showMenuItem);</span><br><span class="line">        new MenuItem(trayMenu, SWT.SEPARATOR);</span><br><span class="line">        // 托盘中的退出菜单，程式只能通过这个菜单退出</span><br><span class="line">        MenuItem exitMenuItem = new MenuItem(trayMenu, SWT.PUSH);</span><br><span class="line"></span><br><span class="line">        exitMenuItem.setText(&quot;退出程序&quot;);</span><br><span class="line">        exitMenuItem.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line"></span><br><span class="line">            public void widgetSelected(SelectionEvent event) &#123;</span><br><span class="line">                ///shellwindow.dispose();</span><br><span class="line">                System.exit(0);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        // 在托盘图标上点击鼠标右键时，弹出系统菜单</span><br><span class="line">        trayItem.addMenuDetectListener(new MenuDetectListener() &#123;</span><br><span class="line">            public void menuDetected(MenuDetectEvent e) &#123;</span><br><span class="line">                trayMenu.setVisible(true);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 肖理达</span><br><span class="line">        Label label_2 = new Label(composite_1, SWT.NONE);</span><br><span class="line">        label_2.setText(&quot;\u540D\u79F0\uFF1A&quot;);</span><br><span class="line">        label_2.setBounds(29, 12, 35, 17);</span><br><span class="line"></span><br><span class="line">        text_1 = new Text(composite_1, SWT.BORDER);</span><br><span class="line">        text_1.setBounds(70, 9, 260, 23);</span><br><span class="line"></span><br><span class="line">        Label label_4 = new Label(composite_1, SWT.NONE);</span><br><span class="line">        label_4.setText(&quot;\u722C\u53D6\u72B6\u6001:&quot;);</span><br><span class="line">        label_4.setBounds(357, 47, 57, 17);</span><br><span class="line"></span><br><span class="line">        Label lblUrl = new Label(composite_1, SWT.NONE);</span><br><span class="line">        lblUrl.setAlignment(SWT.CENTER);</span><br><span class="line">        lblUrl.setText(&quot;URL\uFF1A&quot;);</span><br><span class="line">        lblUrl.setBounds(29, 47, 35, 17);</span><br><span class="line"></span><br><span class="line">        Label label_7 = new Label(composite_1, SWT.NONE);</span><br><span class="line">        label_7.setText(&quot;\u4EFB\u52A1\u7F16\u53F7\uFF1A&quot;);</span><br><span class="line">        label_7.setBounds(357, 12, 57, 17);</span><br><span class="line"></span><br><span class="line">        Button button_8 = new Button(composite_1, SWT.NONE);</span><br><span class="line"></span><br><span class="line">        button_8.setText(&quot;\u67E5\u8BE2&quot;);</span><br><span class="line">        button_8.setBounds(40, 334, 80, 27);</span><br><span class="line"></span><br><span class="line">        table_1 = new Table(composite_1, SWT.BORDER | SWT.FULL_SELECTION | SWT.MULTI);</span><br><span class="line">        table_1.setLinesVisible(true);</span><br><span class="line">        table_1.setHeaderVisible(true);</span><br><span class="line">        table_1.setBounds(10, 82, 766, 239);</span><br><span class="line"></span><br><span class="line">        TableColumn tableColumn_3 = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tableColumn_3.setWidth(60);</span><br><span class="line">        tableColumn_3.setText(&quot;\u8BB0\u5F55\u7F16\u53F7&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tableColumn_4 = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tableColumn_4.setWidth(150);</span><br><span class="line">        tableColumn_4.setText(&quot;\u65F6\u95F4&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnNewColumn = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tblclmnNewColumn.setWidth(70);</span><br><span class="line">        tblclmnNewColumn.setText(&quot;\u72B6\u6001&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnNewColumn_1 = new TableColumn(table_1, SWT.NONE);</span><br><span class="line">        tblclmnNewColumn_1.setWidth(70);</span><br><span class="line">        tblclmnNewColumn_1.setText(&quot;\u4EFB\u52A1\u7F16\u53F7&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnNewColumn_2 = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tblclmnNewColumn_2.setWidth(100);</span><br><span class="line">        tblclmnNewColumn_2.setText(&quot;\u540D\u79F0&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnNewColumn_3 = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tblclmnNewColumn_3.setWidth(140);</span><br><span class="line">        tblclmnNewColumn_3.setText(&quot;\u8DEF\u5F84&quot;);</span><br><span class="line"></span><br><span class="line">        TableColumn tblclmnUrl_1 = new TableColumn(table_1, SWT.LEFT);</span><br><span class="line">        tblclmnUrl_1.setWidth(170);</span><br><span class="line">        tblclmnUrl_1.setText(&quot;URL&quot;);</span><br><span class="line"></span><br><span class="line">        combo = new Combo(composite_1, SWT.NONE);</span><br><span class="line">        combo.setBounds(420, 44, 120, 25);</span><br><span class="line">        combo.setItems(new String[] &#123; &quot;true&quot;, &quot;false&quot; &#125;);</span><br><span class="line"></span><br><span class="line">        Label label_15 = new Label(composite_1, SWT.NONE);</span><br><span class="line">        label_15.setText(&quot;\u722C\u53D6\u65F6\u95F4\uFF1A&quot;);</span><br><span class="line">        label_15.setBounds(570, 12, 61, 17);</span><br><span class="line"></span><br><span class="line">        dateTime = new DateTime(composite_1, SWT.BORDER);</span><br><span class="line">        dateTime.setBounds(642, 9, 98, 24);</span><br><span class="line"></span><br><span class="line">        Label label_16 = new Label(composite_1, SWT.NONE);</span><br><span class="line">        label_16.setText(&quot;\u81F3&quot;);</span><br><span class="line">        label_16.setAlignment(SWT.CENTER);</span><br><span class="line">        label_16.setBounds(594, 47, 20, 17);</span><br><span class="line"></span><br><span class="line">        dateTime_1 = new DateTime(composite_1, SWT.BORDER);</span><br><span class="line">        dateTime_1.setBounds(642, 44, 98, 24);</span><br><span class="line"></span><br><span class="line">        button_12 = new Button(composite_1, SWT.CHECK);</span><br><span class="line">        button_12.setBounds(746, 12, 13, 17);</span><br><span class="line"></span><br><span class="line">        button_13 = new Button(composite_1, SWT.CHECK);</span><br><span class="line">        button_13.setBounds(746, 47, 13, 17);</span><br><span class="line"></span><br><span class="line">        Button button_15 = new Button(composite_1, SWT.NONE);</span><br><span class="line">        button_15.setText(&quot;\u91CD\u7F6E&quot;);</span><br><span class="line">        button_15.setBounds(240, 334, 80, 27);</span><br><span class="line"></span><br><span class="line">        Button button_16 = new Button(composite_1, SWT.NONE);</span><br><span class="line">        button_16.setText(&quot;\u5220\u9664&quot;);</span><br><span class="line">        button_16.setBounds(140, 334, 80, 27);</span><br><span class="line"></span><br><span class="line">        text_2 = new Text(composite_1, SWT.BORDER);</span><br><span class="line">        text_2.setBounds(70, 44, 260, 23);</span><br><span class="line"></span><br><span class="line">        text_3 = new Text(composite_1, SWT.BORDER);</span><br><span class="line">        text_3.setBounds(420, 9, 120, 23);</span><br><span class="line"></span><br><span class="line">        Button button_11 = new Button(composite_1, SWT.NONE);</span><br><span class="line">        button_11.setBounds(440, 334, 60, 27);</span><br><span class="line">        button_11.setText(&quot;\u4E0A\u4E00\u9875&quot;);</span><br><span class="line"></span><br><span class="line">        Button button_14 = new Button(composite_1, SWT.NONE);</span><br><span class="line">        button_14.setText(&quot;\u4E0B\u4E00\u9875&quot;);</span><br><span class="line">        button_14.setBounds(580, 334, 60, 27);</span><br><span class="line"></span><br><span class="line">        spinner = new Spinner(composite_1, SWT.BORDER);</span><br><span class="line">        spinner.setBounds(510, 334, 60, 27);</span><br><span class="line"></span><br><span class="line">        countrec = new Label(composite_1, SWT.NONE);</span><br><span class="line">        countrec.setBounds(656, 339, 120, 17);</span><br><span class="line">        </span><br><span class="line">        // 记录查询 肖理达</span><br><span class="line">        button_8.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                countRec = search(1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 重置按钮 肖理达</span><br><span class="line">        button_15.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                text_1.setText(&quot;&quot;);</span><br><span class="line">                text_2.setText(&quot;&quot;);</span><br><span class="line">                text_3.setText(&quot;&quot;);</span><br><span class="line">                combo.setText(&quot;&quot;);</span><br><span class="line">                button_12.setSelection(false);</span><br><span class="line">                button_13.setSelection(false);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 删除按钮：弹出密码输入框 肖理达</span><br><span class="line">        button_16.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (table_1.getSelectionCount() &gt; 0) &#123;</span><br><span class="line">                    UserCheck userCheck = new UserCheck(shellwindow, SWT.NONE);</span><br><span class="line">                    boolean access = userCheck.open();</span><br><span class="line">                    if (access == false) &#123;</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    TableItem[] tableItems = table_1.getSelection();</span><br><span class="line">                    @SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="line">                    Map&lt;String, Object&gt; ret = (Map&lt;String, Object&gt;) tableItems[0].getData();</span><br><span class="line"></span><br><span class="line">                    String sql = &quot;delete from records where recno=?&quot;;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_INFORMATION);</span><br><span class="line">                    mb.setText(&quot;系统提示&quot;);</span><br><span class="line">                    mb.setMessage(&quot;删除记录成功&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                    try &#123;</span><br><span class="line">                        WTMbackstage.update(sql, ret.get(&quot;RECNO&quot;));</span><br><span class="line">                        recPage = 1;</span><br><span class="line">                        search(recPage);</span><br><span class="line">                    &#125; catch (SQLException e1) &#123;</span><br><span class="line">                        // TODO Auto-generated catch block</span><br><span class="line">                        e1.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING);</span><br><span class="line">                    mb.setText(&quot;WTM-0210  记录选取错误&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请选中记录对象&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 记录查询：上一页 肖理达</span><br><span class="line">        button_11.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (recPage &lt;= 1) &#123;</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                recPage--;</span><br><span class="line">                search(recPage);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 记录查询：下一页 肖理达</span><br><span class="line">        button_14.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if (recPage &lt;= countRec / 10 &amp;&amp; (recPage != countRec / 10 || countRec % 10 != 0)) &#123;</span><br><span class="line">                    recPage++;</span><br><span class="line">                    search(recPage);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        // 输入页码跳转 肖理达</span><br><span class="line">        spinner.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetDefaultSelected(SelectionEvent e) &#123;</span><br><span class="line">                int index = spinner.getSelection();</span><br><span class="line">                if (index &lt; 1 || (index - 1 &gt; countRec / 10 || (index - 1 == countRec / 10 &amp;&amp; countRec % 10 == 0))) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING);</span><br><span class="line">                    mb.setText(&quot;WTM-0211  无效的索引&quot;);</span><br><span class="line">                    mb.setMessage(&quot;页码无效！&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    recPage = spinner.getSelection();</span><br><span class="line">                    search(recPage);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 托盘和窗口状态</span><br><span class="line">    public void toggleDisplay(Shell shell, Tray tray) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            shell.setVisible(!shell.isVisible());</span><br><span class="line">            tray.getItem(0).setVisible(!shell.isVisible());</span><br><span class="line">            if (shell.getVisible()) &#123;</span><br><span class="line">                shell.setMinimized(false);</span><br><span class="line">                shell.setActive();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">     * private Image resize(Image src, int width, int height) &#123; Image scaled = new</span><br><span class="line">     * Image(Display.getDefault(), width, height); GC gc = new GC(scaled); try&#123;</span><br><span class="line">     * gc.setAdvanced(true); // 打开高级绘图模式 gc.setAntialias(SWT.ON);// 设置消除锯齿</span><br><span class="line">     * gc.setInterpolation(SWT.HIGH); // 设置插值 gc.drawImage(src, 0, 0,</span><br><span class="line">     * src.getBounds().width, src.getBounds().height,0, 0, width, height); &#125;finally&#123;</span><br><span class="line">     * gc.dispose(); &#125; return scaled; &#125;</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    // 查询函数 肖理达</span><br><span class="line">    public int search(int recPage) &#123;</span><br><span class="line">        table_1.removeAll();</span><br><span class="line">        List&lt;Object&gt; param = new ArrayList&lt;&gt;();</span><br><span class="line">        String sql = &quot;select * from records where 1=1&quot;;</span><br><span class="line">        if (text_1.getText().length() &gt; 0) &#123;</span><br><span class="line">            sql += &quot; and webname like ?&quot;;</span><br><span class="line">            param.add(&quot;%&quot; + text_1.getText() + &quot;%&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (combo.getText().length() &gt; 0) &#123;</span><br><span class="line">            sql += &quot; and success=?&quot;;</span><br><span class="line">            param.add(combo.getText());</span><br><span class="line">        &#125;</span><br><span class="line">        if (text_2.getText().length() &gt; 0) &#123;</span><br><span class="line">            sql += &quot; and url like ?&quot;;</span><br><span class="line">            param.add(&quot;%&quot; + text_2.getText() + &quot;%&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (text_3.getText().length() &gt; 0) &#123;</span><br><span class="line">            sql += &quot; and taskid=?&quot;;</span><br><span class="line">            param.add(text_3.getText());</span><br><span class="line">        &#125;</span><br><span class="line">        if (button_12.getSelection()) &#123;</span><br><span class="line">            Date start = Date.valueOf(dateTime.getYear() + &quot;-&quot; + (dateTime.getMonth() + 1) + &quot;-&quot; + dateTime.getDay());</span><br><span class="line">            sql += &quot; and time &gt;= ?&quot;;</span><br><span class="line">            param.add(start);</span><br><span class="line">        &#125;</span><br><span class="line">        if (button_13.getSelection()) &#123;</span><br><span class="line">            Date end = Date</span><br><span class="line">                    .valueOf(dateTime_1.getYear() + &quot;-&quot; + (dateTime_1.getMonth() + 1) + &quot;-&quot; + dateTime_1.getDay());</span><br><span class="line">            sql += &quot; and time &lt;= ?&quot;;</span><br><span class="line">            param.add(end);</span><br><span class="line">        &#125;</span><br><span class="line">        Object[] paramArray = param.toArray();</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; queryPage = null;</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; query = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            queryPage = RecordBackstage.queryPage(sql, recPage, 10, paramArray);</span><br><span class="line">            query = WTMbackstage.query(sql, paramArray);</span><br><span class="line">            countRec = query.size();</span><br><span class="line">        &#125; catch (SQLSyntaxErrorException e1) &#123;</span><br><span class="line">            MessageBox mb = new MessageBox(shellwindow, SWT.ICON_WARNING);</span><br><span class="line">            mb.setText(&quot;WTM-0212  参数类型错误&quot;);</span><br><span class="line">            mb.setMessage(&quot;任务编号仅为数字&quot;);</span><br><span class="line">            mb.open();</span><br><span class="line">        &#125; catch (SQLException e1) &#123;</span><br><span class="line">            // TODO Auto-generated catch block</span><br><span class="line">            e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        if (queryPage != null) &#123;</span><br><span class="line">            for (int i = 0; i &lt; queryPage.size(); i++) &#123;</span><br><span class="line">                Map&lt;String, Object&gt; map = queryPage.get(i);</span><br><span class="line">                TableItem tableItem = new TableItem(table_1, SWT.NONE);</span><br><span class="line">                tableItem.setText(new String[] &#123; map.get(&quot;RECNO&quot;).toString(), map.get(&quot;TIME&quot;).toString(),</span><br><span class="line">                        map.get(&quot;SUCCESS&quot;).toString(), map.get(&quot;TASKID&quot;).toString(),</span><br><span class="line">                        (map.get(&quot;WEBNAME&quot;) + &quot;&quot;).toString(), (map.get(&quot;TASKRESULTFILE&quot;) + &quot;&quot;).toString(),</span><br><span class="line">                        (map.get(&quot;URL&quot;) + &quot;&quot;).toString() &#125;);</span><br><span class="line">                tableItem.setData(map);</span><br><span class="line">                spinner.setSelection(recPage);</span><br><span class="line">                countrec.setText(&quot;共&quot; + countRec + &quot;条记录&quot;);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (query == null || query.size() == 0) &#123;</span><br><span class="line">            spinner.setSelection(0);</span><br><span class="line">            countrec.setText(&quot;无符合条件的记录&quot;);</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">        return countRec;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>WTMbackstage</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.io.InputStreamReader;</span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.DriverManager;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.ResultSetMetaData;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.text.DateFormat;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.Calendar;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.LinkedHashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line">import java.util.Properties;</span><br><span class="line">import java.util.Timer;</span><br><span class="line">import java.util.TimerTask;</span><br><span class="line"></span><br><span class="line">public class WTMbackstage &#123;</span><br><span class="line">    private static String url;</span><br><span class="line">    private static String username;</span><br><span class="line">    private static String password;</span><br><span class="line">    public static Connection conn;</span><br><span class="line">    private static Timer timer = null;</span><br><span class="line"></span><br><span class="line">    public static void start() throws IOException, ClassNotFoundException, SQLException &#123;</span><br><span class="line">        Properties p = new Properties();</span><br><span class="line">        System.out.println(&quot;正在尝试读取配置文件...&quot;);</span><br><span class="line">        InputStream in = WTMbackstage.class.getClassLoader().getResourceAsStream(&quot;db.properties&quot;);</span><br><span class="line">        p.load(in);</span><br><span class="line">        String driver = p.getProperty(&quot;driver&quot;);</span><br><span class="line">        url = p.getProperty(&quot;url&quot;);</span><br><span class="line">        username = p.getProperty(&quot;username&quot;);</span><br><span class="line">        password = p.getProperty(&quot;password&quot;);</span><br><span class="line">        System.out.println(&quot;配置文件读取完成&quot;);</span><br><span class="line">        System.out.println(&quot;正在尝试启动Oracle数据库驱动...&quot;);</span><br><span class="line">        Class.forName(driver);</span><br><span class="line">        System.out.println(&quot;启动数据库驱动完成&quot;);</span><br><span class="line">        System.out.println(&quot;正在尝试连接到数据库...&quot;);</span><br><span class="line">        conn = DriverManager.getConnection(url, username, password);</span><br><span class="line">        System.out.println(&quot;连接到数据库完成&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main() &#123;</span><br><span class="line">        // 用于自启动</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 查询所有TaskSheet表记录</span><br><span class="line">    public static void queryTask() throws SQLException &#123;</span><br><span class="line">        String sql = &quot;select * from tasksheet&quot;;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        ResultSetMetaData rsmd = rs.getMetaData();</span><br><span class="line">        for (int i = 1; i &lt;= rsmd.getColumnCount(); i++) &#123;</span><br><span class="line">            String columnName = rsmd.getColumnName(i);</span><br><span class="line">            System.out.print(columnName + &quot;\t\t&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println();</span><br><span class="line">        while (rs.next()) &#123;</span><br><span class="line">            for (int j = 1; j &lt;= rsmd.getColumnCount(); j++) &#123;</span><br><span class="line">                Object columnValue = rs.getObject(j);</span><br><span class="line">                System.out.print(columnValue + &quot;\t&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;</span><br><span class="line">        if (ps != null) &#123;</span><br><span class="line">            ps.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static List&lt;Map&lt;String, Object&gt;&gt; query(String sql, Object... paramArray) throws SQLException &#123;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        for (int i = 0; i &lt; paramArray.length; i++) &#123;</span><br><span class="line">            ps.setObject(i + 1, paramArray[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        // 获取元数据</span><br><span class="line">        ResultSetMetaData rsmd = rs.getMetaData();</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; ret = new ArrayList&lt;&gt;();</span><br><span class="line">        while (rs.next()) &#123;</span><br><span class="line">            Map&lt;String, Object&gt; row = new LinkedHashMap&lt;&gt;();</span><br><span class="line">            for (int i = 1; i &lt;= rsmd.getColumnCount(); i++) &#123;</span><br><span class="line">                String columnName = rsmd.getColumnName(i);</span><br><span class="line">                Object columnValue = rs.getObject(i);</span><br><span class="line">                row.put(columnName, columnValue);</span><br><span class="line">            &#125;</span><br><span class="line">            ret.add(row);</span><br><span class="line">        &#125;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 遍历TaskSheet任务表，爬以上网页</span><br><span class="line">    public static void spider() throws Exception &#123;</span><br><span class="line">        String sql = &quot;select * from tasksheet&quot;;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ResultSet rs = ps.executeQuery();</span><br><span class="line">        while (rs.next()) &#123;</span><br><span class="line">            Map&lt;String, Object&gt; result = new LinkedHashMap&lt;&gt;();</span><br><span class="line">            String mark = Reptile6.Init(rs.getString(&quot;TASKNAME&quot;), rs.getString(&quot;TASKRESULTFILE&quot;),</span><br><span class="line">                    rs.getString(&quot;TASKURLSTR&quot;));</span><br><span class="line">            result.put(&quot;MARK&quot;, mark);</span><br><span class="line">            result.put(&quot;TASKID&quot;, rs.getInt(&quot;TASKID&quot;));</span><br><span class="line">            result.put(&quot;TASKNAME&quot;, rs.getString(&quot;TASKNAME&quot;));</span><br><span class="line">            result.put(&quot;TASKRESULTFILE&quot;, rs.getString(&quot;TASKRESULTFILE&quot;));</span><br><span class="line">            result.put(&quot;TASKURLSTR&quot;, rs.getString(&quot;TASKURLSTR&quot;));</span><br><span class="line">            // 调用 肖理达方法(result);</span><br><span class="line">            RecordBackstage.addRecord(result);</span><br><span class="line">        &#125;</span><br><span class="line">        if (ps != null) &#123;</span><br><span class="line">            ps.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 添加TaskSheet表记录</span><br><span class="line">    public static void insertTask(String... data) throws SQLException &#123;</span><br><span class="line">        String sql = &quot;insert into tasksheet values (Seq_tasksheet_taskid.nextval,?,?,?,?)&quot;;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        for (int i = 0; i &lt; data.length; i++) &#123;</span><br><span class="line">            ps.setObject(i + 1, data[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        ps.executeUpdate();</span><br><span class="line">        if (ps != null) &#123;</span><br><span class="line">            ps.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">     * // 删除TaskSheet表记录 已废弃 public static void deleteTask(int taskid) throws</span><br><span class="line">     * SQLException &#123; String sql = &quot;delete from tasksheet where taskid = ?&quot;;</span><br><span class="line">     * PreparedStatement ps = conn.prepareStatement(sql); ps.setInt(1, taskid);</span><br><span class="line">     * ps.executeUpdate(); if (ps != null) &#123; ps.close(); &#125; &#125;</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    public static int update(String sql, Object... paramArray) throws SQLException &#123;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        for (int i = 0; i &lt; paramArray.length; i++) &#123;</span><br><span class="line">            ps.setObject(i + 1, paramArray[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        return ps.executeUpdate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 数据库操作</span><br><span class="line">    public static void SQLOption(String sql) throws SQLException &#123;</span><br><span class="line">        PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">        ps.executeUpdate();</span><br><span class="line">        if (ps != null) &#123;</span><br><span class="line">            ps.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line">     * // 网页爬虫 已废弃 private static void reptile(String urlName, String resultFile,</span><br><span class="line">     * String cacheFile, String urlStr) throws IOException &#123; URL url = new</span><br><span class="line">     * URL(urlStr); // 获取爬虫时间 long currentTime = System.currentTimeMillis(); //</span><br><span class="line">     * 设置时间格式 DateFormat df = new SimpleDateFormat(&quot;yyyy_MM_dd_HH&quot;); String format =</span><br><span class="line">     * df.format(currentTime);</span><br><span class="line">     *</span><br><span class="line">     * InputStream in = null; OutputStream out = null; Reader r = null; Writer w =</span><br><span class="line">     * null; // cache缓存 URLConnection conin = url.openConnection(); in =</span><br><span class="line">     * conin.getInputStream(); out = new FileOutputStream(cacheFile +</span><br><span class="line">     * &quot;\\&quot; + urlName + &quot;Cache&quot; + format + &quot;.html&quot;); byte b[] = new byte[1024]; int</span><br><span class="line">     * len = 0; while ((len = in.read(b)) != -1) &#123; out.write(b, 0, len); &#125; // 成品 r =</span><br><span class="line">     * new FileReader(cacheFile + &quot;\\&quot; + urlName + &quot;Cache&quot; + format + &quot;.html&quot;); w =</span><br><span class="line">     * new FileWriter(resultFile + &quot;\\&quot; + urlName + &quot; &quot; + format + &quot;.html&quot;);</span><br><span class="line">     * BufferedReader br = new BufferedReader(r); BufferedWriter bw = new</span><br><span class="line">     * BufferedWriter(w); String value = null; boolean flag = true; while ((value =</span><br><span class="line">     * br.readLine()) != null) &#123; // 过滤器 String[] str = value.split(&quot; &quot;); for (int i</span><br><span class="line">     * = 0; i &lt; str.length; i++) &#123; if (str[i].startsWith(&quot;id=\&quot;bd_snap&quot;)) &#123; flag =</span><br><span class="line">     * false; break; &#125; else &#123; flag = true; &#125; &#125; // 写入 if (flag) &#123; bw.write(value);</span><br><span class="line">     * bw.newLine(); &#125; &#125;</span><br><span class="line">     *</span><br><span class="line">     * bw.flush();</span><br><span class="line">     *</span><br><span class="line">     * if (in != null) &#123; in.close(); &#125; if (out != null) &#123; out.close(); &#125; if (r !=</span><br><span class="line">     * null) &#123; r.close(); &#125; if (w != null) &#123; w.close(); &#125;</span><br><span class="line">     *</span><br><span class="line">     * &#125;</span><br><span class="line">     */</span><br><span class="line"></span><br><span class="line">    public static void spiderTimer(int hour, int minute) &#123;</span><br><span class="line">        Calendar calendar = Calendar.getInstance();</span><br><span class="line">        calendar.set(Calendar.HOUR_OF_DAY, hour); // 控制时</span><br><span class="line">        calendar.set(Calendar.MINUTE, minute); // 控制分</span><br><span class="line">        calendar.set(Calendar.SECOND, 0); // 控制秒</span><br><span class="line">        Date time = calendar.getTime();</span><br><span class="line"></span><br><span class="line">        DateFormat df = new SimpleDateFormat(&quot;yyyy年MM月dd日 HH:mm:ss&quot;);</span><br><span class="line">        String format = df.format(time);</span><br><span class="line">        System.out.println(format);</span><br><span class="line"></span><br><span class="line">        timer = new Timer();</span><br><span class="line">        timer.scheduleAtFixedRate(new TimerTask() &#123;</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                System.out.println(&quot;-------设定要指定任务--------&quot;);</span><br><span class="line">                try &#123;</span><br><span class="line">                    spider();</span><br><span class="line">                &#125; catch (SQLException e) &#123;</span><br><span class="line">                    throw new RuntimeException(e);</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    throw new RuntimeException(e);</span><br><span class="line">                &#125; catch (Exception e) &#123;</span><br><span class="line">                    throw new RuntimeException(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            // 启动时间//启动间隔 1000 * 60 * 60 * 24 单位毫秒 (一天24小时)</span><br><span class="line">        &#125;, time, 1000 * 60 * 60 * 24);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void spiderTimerStop() &#123;</span><br><span class="line">        if (timer != null) &#123;</span><br><span class="line">            timer.cancel();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 容创伟</span><br><span class="line">    // 导出 //dmp文件名 dmp文件路径 表名</span><br><span class="line">    public static boolean backupData(String trim, String address, String trim3) throws InterruptedException, IOException &#123;</span><br><span class="line">        boolean isSuccess = false;</span><br><span class="line">        String commandStr = &quot;cmd.exe /c exp &quot;+username+&quot;/&quot;+password+&quot;@orcl file=&quot; + address + &quot;\\&quot; + trim + &quot;.dmp tables=(&quot; + trim3 + &quot;)&quot;;</span><br><span class="line">        Runtime run = Runtime.getRuntime();</span><br><span class="line">        Process process = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            process = run.exec(commandStr);</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            throw new IOException(e1);</span><br><span class="line">        &#125;</span><br><span class="line">        String line = null;</span><br><span class="line">        // 读取ErrorStream很关键，解决了挂起的问题</span><br><span class="line">        BufferedReader br = new BufferedReader(new InputStreamReader(process.getErrorStream()));</span><br><span class="line">        BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((line = br.readLine()) != null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            while ((line = in.readLine()) != null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            in.close();</span><br><span class="line">            br.close();</span><br><span class="line">            process.getOutputStream().close();</span><br><span class="line">            process.waitFor();</span><br><span class="line">            isSuccess = true;</span><br><span class="line">        &#125; catch (IOException ex) &#123;</span><br><span class="line">            throw new IOException(ex);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            throw new InterruptedException();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (in != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (br != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    br.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return isSuccess;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //容创伟</span><br><span class="line">    //导入 文件名 路径</span><br><span class="line">    public static boolean InputData(String address) throws InterruptedException, IOException &#123;</span><br><span class="line">        boolean isSuccess = false;</span><br><span class="line">        String commandStr = &quot;cmd.exe /c imp &quot;+username+&quot;/&quot;+password+&quot;@orcl file=&quot; + address + &quot; full=y&quot;;</span><br><span class="line">        Runtime run = Runtime.getRuntime();</span><br><span class="line">        Process process = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            process = run.exec(commandStr);</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            throw new IOException(e1);</span><br><span class="line">        &#125;</span><br><span class="line">        String line = null;</span><br><span class="line">        // 读取ErrorStream很关键，解决了挂起的问题</span><br><span class="line">        BufferedReader br = new BufferedReader(new InputStreamReader(process.getErrorStream()));</span><br><span class="line">        BufferedReader in = new BufferedReader(new InputStreamReader(process.getInputStream()));</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((line = br.readLine()) != null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            while ((line = in.readLine()) != null) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line">            in.close();</span><br><span class="line">            br.close();</span><br><span class="line">            process.getOutputStream().close();</span><br><span class="line">            process.waitFor();</span><br><span class="line">            isSuccess = true;</span><br><span class="line">        &#125; catch (IOException ex) &#123;</span><br><span class="line">            throw new IOException(ex);</span><br><span class="line">        &#125; catch (InterruptedException e) &#123;</span><br><span class="line">            throw new InterruptedException();</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (in != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (br != null) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    br.close();</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return isSuccess;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserWin</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.FileDialog;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.swt.widgets.Menu;</span><br><span class="line">import org.eclipse.swt.widgets.MenuItem;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class UserWin &#123;</span><br><span class="line"></span><br><span class="line">    protected Shell shell;</span><br><span class="line">    private Text text;</span><br><span class="line">    private Text text_1;</span><br><span class="line">    private static int index;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Launch the application.</span><br><span class="line">     *</span><br><span class="line">     * @param args</span><br><span class="line">     */</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            UserWin window = new UserWin();</span><br><span class="line">            window.open();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the window.</span><br><span class="line">     */</span><br><span class="line">    public void open() &#123;</span><br><span class="line">        Display display = Display.getDefault();</span><br><span class="line">        createContents();</span><br><span class="line">        // 居中显示</span><br><span class="line">        int x = (display.getBounds().width - shell.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shell.getBounds().height) / 2;</span><br><span class="line">        shell.setLocation(x, y);</span><br><span class="line">        shell.open();</span><br><span class="line">        // 自启动</span><br><span class="line">        //WTMbackstage.main();</span><br><span class="line">        shell.layout();</span><br><span class="line">        while (!shell.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the window.</span><br><span class="line">     */</span><br><span class="line">    Display display = new Display();</span><br><span class="line">    protected void createContents() &#123;</span><br><span class="line">        </span><br><span class="line">        shell = new Shell(SWT.CLOSE | SWT.MIN);</span><br><span class="line">        shell.setSize(600, 450);</span><br><span class="line">        shell.setText(&quot;\u7BA1\u7406\u5458\u9996\u9875&quot;);</span><br><span class="line">        </span><br><span class="line">        //Image image = new Image(display, &quot;G:\\WebTimeMachine\\img\\图标.ico&quot;);</span><br><span class="line">        shell.setImage(SWTResourceManager.getImage(UserWin.class, &quot;/img/\u56FE\u6807.ico&quot;));</span><br><span class="line"></span><br><span class="line">        /*Label lblNewLabel = new Label(shell, SWT.NONE);</span><br><span class="line">        Image logo = new Image(display,&quot;G:\\WebTimeMachine\\img\\logo1.png&quot;);</span><br><span class="line">        lblNewLabel.setImage(resize(logo,296,401));</span><br><span class="line">        lblNewLabel.setBounds(0, 0, 296, 401);*/</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shell, SWT.NONE);</span><br><span class="line">        label.setBounds(320, 109, 48, 20);</span><br><span class="line">        label.setText(&quot;\u7BA1\u7406\u5458\uFF1A&quot;);</span><br><span class="line">    </span><br><span class="line">        text = new Text(shell, SWT.BORDER);</span><br><span class="line">        text.setBounds(388, 106, 170, 26);</span><br><span class="line"></span><br><span class="line">        Label label_1 = new Label(shell, SWT.NONE);</span><br><span class="line">        label_1.setBounds(320, 163, 48, 20);</span><br><span class="line">        label_1.setText(&quot;\u5BC6   \u94A5\uFF1A&quot;);</span><br><span class="line"></span><br><span class="line">        text_1 = new Text(shell, SWT.BORDER | SWT.PASSWORD);</span><br><span class="line">        text_1.setBounds(388, 160, 170, 26);</span><br><span class="line"></span><br><span class="line">        Button button = new Button(shell, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                //配置文件 数据库驱动 数据库连接 启动</span><br><span class="line">                try &#123;</span><br><span class="line">                    WTMbackstage.start();</span><br><span class="line">                &#125; catch (ClassNotFoundException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shell, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0101  初始化可能遇到错误&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125; catch (IOException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shell, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0102  初始化可能遇到错误&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125; catch (SQLException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shell, SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0103  初始化可能遇到错误&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">                try &#123;</span><br><span class="line">                    String sql = &quot;select * from AdminisAcount&quot;;</span><br><span class="line">                                                    //触发WTMbackstage的静态块</span><br><span class="line">                    List&lt;Map&lt;String, Object&gt;&gt; ret = WTMbackstage.query(sql);</span><br><span class="line">                    WTMwindow window = new WTMwindow();</span><br><span class="line">                    boolean flag = false;</span><br><span class="line">                    for (int i = 0; i &lt; ret.size(); i++) &#123;</span><br><span class="line">                        if (text.getText().trim().equals(ret.get(i).get(&quot;ADNAME&quot;))</span><br><span class="line">                                &amp;&amp; text_1.getText().trim().equals(ret.get(i).get(&quot;ADPASSWORD&quot;))) &#123;</span><br><span class="line">                            shell.setVisible(false);</span><br><span class="line">                            WTMbackstage.SQLOption(</span><br><span class="line">                                    &quot;update AdminisAcount set ADTIME = sysdate where ADID = &quot; + ret.get(i).get(&quot;ADID&quot;));</span><br><span class="line">                            index = Integer.parseInt(ret.get(i).get(&quot;ADID&quot;)+&quot;&quot;);</span><br><span class="line">                            window.open();</span><br><span class="line">                            flag = true;</span><br><span class="line">                            break;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    if (!flag) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shell, SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-0104  访问被拒绝&quot;);</span><br><span class="line">                        mb.setMessage(&quot;管理员/密钥不合法，拒绝访问&quot;);</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (Exception e2) &#123;</span><br><span class="line">                    e2.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(388, 239, 98, 30);</span><br><span class="line">        button.setText(&quot;\u767B\u5F55&quot;);</span><br><span class="line">        </span><br><span class="line">        Menu menu = new Menu(shell, SWT.BAR);</span><br><span class="line">        shell.setMenuBar(menu);</span><br><span class="line">        </span><br><span class="line">        MenuItem menuItem = new MenuItem(menu, SWT.CASCADE);</span><br><span class="line">        menuItem.setText(&quot;\u7CFB\u7EDF\u914D\u7F6E&quot;);</span><br><span class="line">        </span><br><span class="line">        Menu menu_1 = new Menu(menuItem);</span><br><span class="line">        menuItem.setMenu(menu_1);</span><br><span class="line">        </span><br><span class="line">        MenuItem menuItem_1 = new MenuItem(menu_1, SWT.NONE);</span><br><span class="line">        menuItem_1.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    FileDialog fileDialog = new FileDialog(shell);</span><br><span class="line">                    String flag = fileDialog.open();</span><br><span class="line">                    String address = fileDialog.getFilterPath()+&quot;\\&quot;+fileDialog.getFileName();</span><br><span class="line">                    //打开应用路径    打开配置文件路径</span><br><span class="line">                    if(flag!=null) &#123;</span><br><span class="line">                        String str = &quot;C:\\WINDOWS\\system32\\notepad.exe &quot; + address;</span><br><span class="line">                        Runtime.getRuntime().exec(str);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (IOException | NullPointerException e2) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0105  获取配置文件失败&quot;);</span><br><span class="line">                    mb.setMessage(e2.getMessage());</span><br><span class="line">                    mb.open();    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        menuItem_1.setText(&quot;\u914D\u7F6E\u6587\u4EF6&quot;);</span><br><span class="line">        </span><br><span class="line">        Label lblNewLabel = new Label(shell, SWT.NONE);</span><br><span class="line">        lblNewLabel.setImage(SWTResourceManager.getImage(UserWin.class, &quot;/img/logo1.png&quot;));</span><br><span class="line">        lblNewLabel.setBounds(0, 0, 300, 401);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    /*private Image resize(Image src, int width, int height) &#123;</span><br><span class="line">        Image scaled = new Image(Display.getDefault(), width, height);</span><br><span class="line">        GC gc = new GC(scaled);</span><br><span class="line">        try&#123;</span><br><span class="line">            gc.setAdvanced(true); // 打开高级绘图模式</span><br><span class="line">            gc.setAntialias(SWT.ON);// 设置消除锯齿</span><br><span class="line">            gc.setInterpolation(SWT.HIGH); // 设置插值</span><br><span class="line">            gc.drawImage(src, 0, 0, src.getBounds().width, src.getBounds().height,0, 0, width, height);</span><br><span class="line">        &#125;finally&#123;</span><br><span class="line">            gc.dispose();</span><br><span class="line">        &#125;</span><br><span class="line">        return scaled;</span><br><span class="line">    &#125;*/</span><br><span class="line"></span><br><span class="line">    public static int getIndex() &#123;</span><br><span class="line">        return index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>UserCheck</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line"></span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class UserCheck extends Dialog &#123;</span><br><span class="line">    // 删除时验证记录</span><br><span class="line"></span><br><span class="line">    //private static int userId;</span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shell;</span><br><span class="line">    private Label label_1;</span><br><span class="line">    private Text text_1;</span><br><span class="line">    private boolean access;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     *</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public UserCheck(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     *</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public boolean open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        Display display = getParent().getDisplay();</span><br><span class="line">        int x = (display.getBounds().width - shell.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shell.getBounds().height) / 2;</span><br><span class="line">        shell.setLocation(x, y);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shell, SWT.NONE);</span><br><span class="line">        label.setImage(SWTResourceManager.getImage(UserCheck.class, &quot;/img/delete.png&quot;));</span><br><span class="line">        label.setBounds(0, 0, 133, 171);</span><br><span class="line">        shell.open();</span><br><span class="line">        shell.layout();</span><br><span class="line"></span><br><span class="line">        while (!shell.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return access;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shell = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shell.setSize(400, 200);</span><br><span class="line">        shell.setText(&quot;\u767B\u5F55\u9A8C\u8BC1&quot;);</span><br><span class="line"></span><br><span class="line">        label_1 = new Label(shell, SWT.NONE);</span><br><span class="line">        label_1.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 12, SWT.NORMAL));</span><br><span class="line">        label_1.setAlignment(SWT.CENTER);</span><br><span class="line">        label_1.setText(&quot;\u5BC6\u7801\uFF1A&quot;);</span><br><span class="line">        label_1.setBounds(147, 44, 56, 23);</span><br><span class="line"></span><br><span class="line">        text_1 = new Text(shell, SWT.BORDER | SWT.PASSWORD);</span><br><span class="line">        text_1.setBounds(209, 45, 160, 23);</span><br><span class="line"></span><br><span class="line">        Button btnNewButton = new Button(shell, SWT.NONE);</span><br><span class="line">        btnNewButton.setBounds(175, 87, 80, 27);</span><br><span class="line">        btnNewButton.setText(&quot;\u786E\u8BA4&quot;);</span><br><span class="line"></span><br><span class="line">        Button button = new Button(shell, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                shell.close();</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setText(&quot;\u53D6\u6D88&quot;);</span><br><span class="line">        button.setBounds(269, 87, 80, 27);</span><br><span class="line"></span><br><span class="line">        btnNewButton.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                int userId=UserWin.getIndex();</span><br><span class="line">                List&lt;Object&gt; param = new ArrayList&lt;&gt;();</span><br><span class="line">                String sql = &quot;select Adpassword from AdminisAcount where adid=?&quot;;</span><br><span class="line">                param.add(userId);</span><br><span class="line">                Object[] paramArray = param.toArray();</span><br><span class="line">                Map&lt;String, Object&gt; query = null;</span><br><span class="line">                query = RecordBackstage.queryOne(sql, paramArray);</span><br><span class="line">                if (query != null) &#123;</span><br><span class="line">                    if (!(query.get(&quot;ADPASSWORD&quot;).toString().equals(text_1.getText()))) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shell, SWT.ICON_WARNING);</span><br><span class="line">                        mb.setText(&quot;WTM-0701 访问被拒绝&quot;);</span><br><span class="line">                        mb.setMessage(&quot;密钥不合法，拒绝访问&quot;);</span><br><span class="line">                        mb.open();</span><br><span class="line">                        access = false;</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    access = true;</span><br><span class="line">                    shell.close();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                access=false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Reptile6</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import java.io.BufferedReader;</span><br><span class="line">import java.io.File;</span><br><span class="line">import java.io.FileNotFoundException;</span><br><span class="line">import java.io.FileOutputStream;</span><br><span class="line">import java.io.FileReader;</span><br><span class="line">import java.io.IOException;</span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.net.MalformedURLException;</span><br><span class="line">import java.net.URL;</span><br><span class="line">import java.net.URLConnection;</span><br><span class="line">import java.text.DateFormat;</span><br><span class="line">import java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line">public class Reptile6 &#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        //测试系统</span><br><span class="line">        /*try &#123;</span><br><span class="line">            Init(&quot;腾讯游戏&quot;,&quot;G:\\WebMuseum\\result\\腾讯游戏&quot;,&quot;https://www.qq.com/&quot;);</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">        &#125;*/</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    @SuppressWarnings(&quot;resource&quot;)</span><br><span class="line">    public static String Init(String urlName, String resultFile, String urlStr) &#123;</span><br><span class="line">        URL url = null;</span><br><span class="line">        String address = null;</span><br><span class="line">        InputStream in = null;</span><br><span class="line">        // 判断url是否存在</span><br><span class="line">        try &#123;</span><br><span class="line">            url = new URL(urlStr);</span><br><span class="line">        &#125; catch (MalformedURLException e1) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        URLConnection conin;</span><br><span class="line">        try &#123;</span><br><span class="line">            conin = url.openConnection();</span><br><span class="line">            in = conin.getInputStream();</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 判断路径是否存在</span><br><span class="line">        address = resultFile;</span><br><span class="line">        File hasFile = new File(address);</span><br><span class="line">        if (!(hasFile.exists())) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 时间戳</span><br><span class="line">        long currentTime = System.currentTimeMillis();</span><br><span class="line">        DateFormat df = new SimpleDateFormat(&quot;yyyy_MM_dd_HH&quot;);</span><br><span class="line">        String format = df.format(currentTime);</span><br><span class="line"></span><br><span class="line">        // 创建时间戳分类文件夹</span><br><span class="line">        File file = new File(address + &quot;\\&quot; + urlName + &quot;_&quot; + format);</span><br><span class="line">        if (!(file.exists())) &#123;</span><br><span class="line">            file.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FileOutputStream out;</span><br><span class="line">        try &#123;</span><br><span class="line">            out = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + &quot;Main.html&quot;);</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        byte b[] = new byte[1024];</span><br><span class="line">        int len = 0;</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((len = in.read(b)) != -1) &#123;</span><br><span class="line">                out.write(b, 0, len);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 获取CSS</span><br><span class="line">        FileReader readCss;</span><br><span class="line">        try &#123;</span><br><span class="line">            readCss = new FileReader(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + &quot;Main.html&quot;);</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BufferedReader brCss = new BufferedReader(readCss);</span><br><span class="line">        String Cssvalue = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((Cssvalue = brCss.readLine()) != null) &#123;</span><br><span class="line">                String[] valueCss = Cssvalue.split(&quot; &quot;);</span><br><span class="line">                for (int i = 0; i &lt; valueCss.length; i++) &#123;</span><br><span class="line">                    if (valueCss[i].startsWith(&quot;&lt;link&quot;) | valueCss[i].endsWith(&quot;&lt;link&quot;)) &#123;</span><br><span class="line">                        String findLink = Cssvalue;</span><br><span class="line">                        String[] findHREF = findLink.split(&quot; &quot;);</span><br><span class="line">                        for (int j = 0; j &lt; findHREF.length; j++) &#123;</span><br><span class="line">                            if (findHREF[j].startsWith(&quot;href=&quot;)) &#123;</span><br><span class="line">                                String[] findURL = findHREF[j].split(&quot;\&quot;&quot;);</span><br><span class="line">                                InputStream inCss = null;</span><br><span class="line">                                URL urlCss = null;</span><br><span class="line">                                try &#123;</span><br><span class="line">                                    if (findURL[1].startsWith(&quot;http&quot;)) &#123;</span><br><span class="line">                                        urlCss = new URL(findURL[1]);</span><br><span class="line">                                    &#125; else &#123;</span><br><span class="line">                                        urlCss = new URL(&quot;http:&quot; + findURL[1]);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    URLConnection coninCss = urlCss.openConnection();</span><br><span class="line">                                    inCss = coninCss.getInputStream();</span><br><span class="line">                                &#125; catch (MalformedURLException e1) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125; catch (IOException e2) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125; catch (Exception e3) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                FileOutputStream outCss = null;</span><br><span class="line"></span><br><span class="line">                                try &#123;</span><br><span class="line">                                    if (findURL[1].endsWith(&quot;.ico&quot;)) &#123;</span><br><span class="line">                                        outCss = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + findURL[1].hashCode() + &quot;.ico&quot;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    if (findURL[1].endsWith(&quot;.svg&quot;)) &#123;</span><br><span class="line">                                        outCss = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + findURL[1].hashCode() + &quot;.svg&quot;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    if (findURL[1].endsWith(&quot;.png&quot;)) &#123;</span><br><span class="line">                                        outCss = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + findURL[1].hashCode() + &quot;.png&quot;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    if (findURL[1].endsWith(&quot;.css&quot;)) &#123;</span><br><span class="line">                                        outCss = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + findURL[1].hashCode() + &quot;.css&quot;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    if (outCss == null) &#123;</span><br><span class="line">                                        outCss = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + findURL[1].hashCode() + &quot;.css&quot;);</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line">                                if (outCss != null) &#123;</span><br><span class="line">                                    byte bCss[] = new byte[1024];</span><br><span class="line">                                    int lenCss = -1;</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        while ((lenCss = inCss.read(bCss)) != -1) &#123;</span><br><span class="line">                                            outCss.write(bCss, 0, lenCss);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125; catch (IOException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    System.out.println(&quot;http:&quot; + findURL[1]);</span><br><span class="line">                                &#125;</span><br><span class="line">                                if(inCss!=null) &#123;</span><br><span class="line">                                    inCss.close();</span><br><span class="line">                                &#125;</span><br><span class="line">                                if(outCss!=null) &#123;</span><br><span class="line">                                    outCss.close();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if(brCss!=null) &#123;</span><br><span class="line">                brCss.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if(readCss!=null) &#123;</span><br><span class="line">                readCss.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            //e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // 获取Img</span><br><span class="line">        FileReader readImg;</span><br><span class="line">        try &#123;</span><br><span class="line">            readImg = new FileReader(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + &quot;Main.html&quot;);</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            //e1.printStackTrace();</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        BufferedReader bfImg = new BufferedReader(readImg);</span><br><span class="line">        String imgValue = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((imgValue = bfImg.readLine()) != null) &#123;</span><br><span class="line">                String[] valueImg = imgValue.split(&quot; &quot;);</span><br><span class="line">                for (int i = 0; i &lt; valueImg.length; i++) &#123;</span><br><span class="line">                    if (valueImg[i].startsWith(&quot;&lt;img&quot;) | valueImg[i].endsWith(&quot;&lt;img&quot;)) &#123;</span><br><span class="line">                        String findImg = imgValue;</span><br><span class="line">                        String[] find = findImg.split(&quot; &quot;);</span><br><span class="line">                        for (int j = 0; j &lt; find.length; j++) &#123;</span><br><span class="line">                            if (find[j].startsWith(&quot;src=&quot;)) &#123;</span><br><span class="line">                                String findSrc = find[j];</span><br><span class="line">                                String[] findURL = findSrc.split(&quot;\&quot;&quot;);</span><br><span class="line">                                if (findURL.length &gt; 1) &#123;</span><br><span class="line">                                    String URL = findURL[1];</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        getImg(URL, address, urlName, format);</span><br><span class="line">                                    &#125; catch (IOException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                            &#125;</span><br><span class="line">                            if (find[j].startsWith(&quot;data-original=&quot;)) &#123;</span><br><span class="line">                                String findData = find[j];</span><br><span class="line">                                String[] findURL = findData.split(&quot;\&quot;&quot;);</span><br><span class="line">                                if (findURL.length &gt; 1) &#123;</span><br><span class="line">                                    String URL = findURL[1];</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        getImg(URL, address, urlName, format);</span><br><span class="line">                                    &#125; catch (IOException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            if (find[j].startsWith(&quot;data-ysrc=&quot;)) &#123;</span><br><span class="line">                                String findData = find[j];</span><br><span class="line">                                String[] findURL = findData.split(&quot;\&quot;&quot;);</span><br><span class="line">                                if (findURL.length &gt; 1) &#123;</span><br><span class="line">                                    String URL = findURL[1];</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        getImg(URL, address, urlName, format);</span><br><span class="line">                                    &#125; catch (IOException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if(bfImg!=null) &#123;</span><br><span class="line">                bfImg.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if(readImg!=null) &#123;</span><br><span class="line">                readImg.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e1) &#123;</span><br><span class="line">            //e1.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        // 获取js</span><br><span class="line">        FileReader readJs;</span><br><span class="line">        try &#123;</span><br><span class="line">            readJs = new FileReader(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + &quot;Main.html&quot;);</span><br><span class="line">        &#125; catch (FileNotFoundException e1) &#123;</span><br><span class="line">            //e1.printStackTrace();</span><br><span class="line">            return &quot;false&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        BufferedReader brJs = new BufferedReader(readJs);</span><br><span class="line">        String JsValues = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            while ((JsValues = brJs.readLine()) != null) &#123;</span><br><span class="line">                String[] valueJs = JsValues.split(&quot; &quot;);</span><br><span class="line">                for (int i = 0; i &lt; valueJs.length; i++) &#123;</span><br><span class="line">                    if (valueJs[i].startsWith(&quot;&lt;script&quot;) | valueJs[i].endsWith(&quot;&lt;script&quot;)) &#123;</span><br><span class="line">                        String findJs = JsValues;</span><br><span class="line">                        String[] find = findJs.split(&quot; &quot;);</span><br><span class="line">                        for (int j = 0; j &lt; find.length; j++) &#123;</span><br><span class="line">                            if (find[j].startsWith(&quot;src=&quot;)) &#123;</span><br><span class="line">                                String findURL = find[j];</span><br><span class="line">                                String[] getURL = findURL.split(&quot;\&quot;&quot;);</span><br><span class="line"></span><br><span class="line">                                InputStream inJs = null;</span><br><span class="line">                                URL urlJs = null;</span><br><span class="line">                                try &#123;</span><br><span class="line">                                    if (getURL.length &gt; 1) &#123;</span><br><span class="line">                                        if (getURL[1].startsWith(&quot;http&quot;)) &#123;</span><br><span class="line">                                            urlJs = new URL(getURL[1]);</span><br><span class="line">                                        &#125; else &#123;</span><br><span class="line">                                            urlJs = new URL(&quot;https:&quot; + getURL[1]);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    URLConnection coninJs = urlJs.openConnection();</span><br><span class="line">                                    inJs = coninJs.getInputStream();</span><br><span class="line">                                &#125; catch (MalformedURLException e) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125; catch (IOException e) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125; catch (Exception e) &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                                FileOutputStream outJs = null;</span><br><span class="line">                                if (getURL.length &gt; 1) &#123;</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        outJs = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot;</span><br><span class="line">                                                + getURL[1].hashCode() + &quot;.js&quot;);</span><br><span class="line">                                    &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    continue;</span><br><span class="line">                                &#125;</span><br><span class="line">                                if (outJs != null) &#123;</span><br><span class="line">                                    byte bJs[] = new byte[1024];</span><br><span class="line">                                    int lenJs = -1;</span><br><span class="line">                                    try &#123;</span><br><span class="line">                                        while ((lenJs = inJs.read(bJs)) != -1) &#123;</span><br><span class="line">                                            outJs.write(bJs, 0, lenJs);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125; catch (IOException e) &#123;</span><br><span class="line">                                        continue;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    System.out.println(&quot;http:&quot; + getURL[1]);</span><br><span class="line">                                &#125;</span><br><span class="line">                                if(inJs!=null) &#123;</span><br><span class="line">                                    inJs.close();</span><br><span class="line">                                &#125;</span><br><span class="line">                                if(outJs!=null) &#123;</span><br><span class="line">                                    outJs.close();</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if(brJs!=null) &#123;</span><br><span class="line">                brJs.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if(readJs!=null) &#123;</span><br><span class="line">                readJs.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            if(in!=null) &#123;</span><br><span class="line">                in.close();</span><br><span class="line">            &#125;</span><br><span class="line">            if(out!=null) &#123;</span><br><span class="line">                out.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            //</span><br><span class="line">        &#125;</span><br><span class="line">        return &quot;true&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    public static void getImg(String url, String address, String urlName, String format) throws IOException &#123;</span><br><span class="line">        URL imgUrl = null;</span><br><span class="line">        InputStream imgIn = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            if (url.startsWith(&quot;http&quot;)) &#123;</span><br><span class="line">                imgUrl = new URL(url);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                imgUrl = new URL(&quot;http:&quot; + url);</span><br><span class="line">            &#125;</span><br><span class="line">            URLConnection imgCon = imgUrl.openConnection();</span><br><span class="line">            imgIn = imgCon.getInputStream();</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        FileOutputStream imgOut = null;</span><br><span class="line">        if (url.endsWith(&quot;.gif&quot;)) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.gif&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (url.endsWith(&quot;.png&quot;)) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.png&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (url.endsWith(&quot;.jpg&quot;)) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.jpg&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (url.endsWith(&quot;.jpeg&quot;)) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.jpeg&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (url.endsWith(&quot;/0&quot;)) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.jpeg&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (imgOut == null) &#123;</span><br><span class="line">            imgOut = new FileOutputStream(address + &quot;\\&quot; + urlName + &quot;_&quot; + format + &quot;\\&quot; + imgUrl.hashCode() + &quot;.webp&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        if (imgOut != null) &#123;</span><br><span class="line">            byte i1[] = new byte[1024];</span><br><span class="line">            int imgLen = 0;</span><br><span class="line">            while ((imgLen = imgIn.read(i1)) != -1) &#123;</span><br><span class="line">                imgOut.write(i1, 0, imgLen);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(imgUrl);</span><br><span class="line">        &#125;</span><br><span class="line">        if(imgIn!=null) &#123;</span><br><span class="line">            imgIn.close();</span><br><span class="line">        &#125;</span><br><span class="line">        if(imgOut!=null) &#123;</span><br><span class="line">            imgOut.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>RecordBackstage</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import java.sql.Connection;</span><br><span class="line">import java.sql.PreparedStatement;</span><br><span class="line">import java.sql.ResultSet;</span><br><span class="line">import java.sql.ResultSetMetaData;</span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.LinkedHashMap;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">public class RecordBackstage &#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    // 添加记录</span><br><span class="line">    public static void addRecord(Map&lt;String, Object&gt; record) throws SQLException &#123;</span><br><span class="line">        String sql = &quot;insert into records values(seq_rec_no.nextval,sysdate,?,?,?,?,?,?)&quot;;</span><br><span class="line">        List&lt;Object&gt; param = new ArrayList&lt;&gt;();</span><br><span class="line">        param.add(record.get(&quot;MARK&quot;));</span><br><span class="line">        param.add(record.get(&quot;TASKID&quot;));</span><br><span class="line">        param.add(record.get(&quot;TASKRESULTFILE&quot;));</span><br><span class="line">        param.add(record.get(&quot;TASKNAME&quot;));</span><br><span class="line">        param.add(record.get(&quot;TASKURLSTR&quot;));</span><br><span class="line">        param.add(null);</span><br><span class="line">        Object[] paramArray = param.toArray();</span><br><span class="line">        WTMbackstage.update(sql, paramArray);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 分页查询</span><br><span class="line">    public static List&lt;Map&lt;String, Object&gt;&gt; queryPage(String sql, int page, int rows, Object... paramArray)</span><br><span class="line">            throws SQLException &#123;</span><br><span class="line">        int startrows = (page - 1) * rows;</span><br><span class="line">        int endrows = page * rows;</span><br><span class="line">        sql = &quot;select t.* from(select t.*,rownum rn from(&quot; + sql + &quot;) t) t where t.rn &lt;=? and t.rn&gt;?&quot;;</span><br><span class="line">        Object[] newparamArray = new Object[paramArray.length + 2];</span><br><span class="line">        System.arraycopy(paramArray, 0, newparamArray, 0, paramArray.length);</span><br><span class="line">        newparamArray[newparamArray.length - 2] = endrows;</span><br><span class="line">        newparamArray[newparamArray.length - 1] = startrows;</span><br><span class="line">        return WTMbackstage.query(sql, newparamArray);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public static Map&lt;String, Object&gt; queryOne(String sql, Object... paramArray) &#123;</span><br><span class="line">        Connection conn = null;</span><br><span class="line">        try &#123;</span><br><span class="line">            conn = WTMbackstage.conn;</span><br><span class="line">            PreparedStatement ps = conn.prepareStatement(sql);</span><br><span class="line">            for (int i = 0; i &lt; paramArray.length; i++) &#123;</span><br><span class="line">                ps.setObject(i + 1, paramArray[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            ResultSet rs = ps.executeQuery();</span><br><span class="line">            ResultSetMetaData rsmd = rs.getMetaData();</span><br><span class="line">            Map&lt;String, Object&gt; row = new LinkedHashMap&lt;&gt;();</span><br><span class="line">            if (rs.next()) &#123;</span><br><span class="line">                for (int i = 1; i &lt;= rsmd.getColumnCount(); i++) &#123;</span><br><span class="line">                    String columnName = rsmd.getColumnName(i);</span><br><span class="line">                    Object columValue = rs.getObject(i);</span><br><span class="line">                    row.put(columnName, columValue);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return row;</span><br><span class="line"></span><br><span class="line">        &#125; catch (SQLException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonalCenter</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line"></span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line"></span><br><span class="line">public class PersonalCenter extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shell;</span><br><span class="line">    private Text text;</span><br><span class="line">    private Text text_1;</span><br><span class="line">    private Text text_2;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public PersonalCenter(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        Display display = getParent().getDisplay();</span><br><span class="line">        int x = (display.getBounds().width - shell.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shell.getBounds().height) / 2;</span><br><span class="line">        shell.setLocation(x, y);</span><br><span class="line">        shell.open();</span><br><span class="line">        shell.layout();</span><br><span class="line">        while (!shell.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shell = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shell.setSize(450, 300);</span><br><span class="line">        shell.setText(&quot;\u4E2A\u4EBA\u4E2D\u5FC3&quot;);</span><br><span class="line">        </span><br><span class="line">        Label lblNewLabel = new Label(shell, SWT.NONE);</span><br><span class="line">        lblNewLabel.setImage(SWTResourceManager.getImage(PersonalCenter.class, &quot;/img/bg_1.png&quot;));</span><br><span class="line">        lblNewLabel.setBounds(0, 0, 444, 34);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shell, SWT.NONE);</span><br><span class="line">        label.setImage(SWTResourceManager.getImage(PersonalCenter.class, &quot;/img/bg_1.png&quot;));</span><br><span class="line">        label.setBounds(0, 237, 444, 34);</span><br><span class="line">        </span><br><span class="line">        Label label_1 = new Label(shell, SWT.CENTER);</span><br><span class="line">        label_1.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 14, SWT.NORMAL));</span><br><span class="line">        label_1.setBounds(175, 40, 76, 25);</span><br><span class="line">        label_1.setText(&quot;\u4E2A\u4EBA\u4E2D\u5FC3&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_2 = new Label(shell, SWT.NONE);</span><br><span class="line">        label_2.setBounds(104, 88, 47, 17);</span><br><span class="line">        label_2.setText(&quot;\u7BA1\u7406\u5458\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        text = new Text(shell, SWT.BORDER);</span><br><span class="line">        text.setEnabled(false);</span><br><span class="line">        text.setBounds(157, 85, 170, 23);</span><br><span class="line">        </span><br><span class="line">        text_1 = new Text(shell, SWT.BORDER);</span><br><span class="line">        text_1.setBounds(157, 114, 170, 23);</span><br><span class="line">        </span><br><span class="line">        Label label_3 = new Label(shell, SWT.NONE);</span><br><span class="line">        label_3.setBounds(104, 117, 47, 17);</span><br><span class="line">        label_3.setText(&quot;\u65B0\u5BC6\u94A5\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_4 = new Label(shell, SWT.NONE);</span><br><span class="line">        label_4.setBounds(86, 146, 65, 17);</span><br><span class="line">        label_4.setText(&quot;\u786E\u8BA4\u65B0\u5BC6\u94A5\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        text_2 = new Text(shell, SWT.BORDER);</span><br><span class="line">        text_2.setBounds(157, 143, 170, 23);</span><br><span class="line">        </span><br><span class="line">        int index = UserWin.getIndex();</span><br><span class="line">        </span><br><span class="line">        Button button = new Button(shell, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if(text_1.getText().trim().length()&gt;0 &amp;&amp; text_2.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    if(text_1.getText().equals(text_2.getText())) &#123;</span><br><span class="line">                        String sql = &quot; update AdminisAcount set ADPASSWORD = &quot;+ text_1.getText() +&quot; where ADID = &quot; + index;</span><br><span class="line">                        try &#123;</span><br><span class="line">                            WTMbackstage.SQLOption(sql);</span><br><span class="line">                            MessageBox mb = new MessageBox(shell,SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                            mb.setText(&quot;系统提示&quot;);</span><br><span class="line">                            mb.setMessage(&quot;密码修改成功，请重新登陆&quot;);</span><br><span class="line">                            mb.open();</span><br><span class="line">                            System.exit(0);</span><br><span class="line">                        &#125; catch (SQLException e1) &#123;</span><br><span class="line">                            MessageBox mb = new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                            mb.setText(&quot;WTM-1301  数据库遇到错误&quot;);</span><br><span class="line">                            mb.setMessage(e1.getMessage());</span><br><span class="line">                            mb.open();</span><br><span class="line">                            return;</span><br><span class="line">                        &#125;                        </span><br><span class="line">                    &#125;else &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shell,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-1302  输入密钥两次不一致&quot;);</span><br><span class="line">                        mb.setMessage(&quot;输入密钥两次不一致&quot;);</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shell,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-1303  密钥不可为空&quot;);</span><br><span class="line">                    mb.setMessage(&quot;密钥不可为空&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(137, 185, 80, 27);</span><br><span class="line">        button.setText(&quot;\u786E\u8BA4&quot;);</span><br><span class="line">        </span><br><span class="line">        Button button_1 = new Button(shell, SWT.NONE);</span><br><span class="line">        button_1.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                shell.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button_1.setBounds(223, 185, 80, 27);</span><br><span class="line">        button_1.setText(&quot;\u53D6\u6D88&quot;);</span><br><span class="line">        </span><br><span class="line">        String sql = &quot;select ADNAME from AdminisAcount where ADID = ?&quot;;</span><br><span class="line">        try &#123;</span><br><span class="line">            List&lt;Map&lt;String,Object&gt;&gt; ret = WTMbackstage.query(sql,index);</span><br><span class="line">            String ADname = ret.get(0).get(&quot;ADNAME&quot;)+&quot;&quot;;</span><br><span class="line">            text.setText(ADname);</span><br><span class="line">        &#125; catch (SQLException e1) &#123;</span><br><span class="line">            MessageBox mb = new MessageBox(shell,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">            mb.setText(&quot;WTM-1304  数据库遇到错误&quot;);</span><br><span class="line">            mb.setMessage(e1.getMessage());</span><br><span class="line">            mb.open();</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OracleFileOut</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.DirectoryDialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.widgets.Combo;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class OracleFileOut extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shlDmp;</span><br><span class="line">    private Text txtFile;</span><br><span class="line">    private Text txtGwebtimemachinedemotable;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public OracleFileOut(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        // 居中显示</span><br><span class="line">        Display display = Display.getDefault();</span><br><span class="line">        int x = (display.getBounds().width - shlDmp.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shlDmp.getBounds().height) / 2;</span><br><span class="line">        shlDmp.setLocation(x, y);</span><br><span class="line">        shlDmp.open();</span><br><span class="line">        shlDmp.layout();</span><br><span class="line">        //Display display = getParent().getDisplay();</span><br><span class="line">        while (!shlDmp.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shlDmp = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shlDmp.setSize(400, 300);</span><br><span class="line">        shlDmp.setText(&quot;DMP\u6587\u4EF6\u5BFC\u51FA&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label.setBounds(35, 64, 61, 17);</span><br><span class="line">        label.setText(&quot;\u6587\u4EF6\u540D\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_1 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_1.setBounds(35, 142, 61, 17);</span><br><span class="line">        label_1.setText(&quot;\u5BFC\u51FA\u8DEF\u5F84\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_2 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_2.setBounds(35, 104, 61, 17);</span><br><span class="line">        label_2.setText(&quot;\u76EE\u6807\u8868\u540D\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        txtFile = new Text(shlDmp, SWT.BORDER);</span><br><span class="line">        txtFile.setText(&quot;file&quot;);</span><br><span class="line">        txtFile.setBounds(102, 61, 131, 23);</span><br><span class="line">        </span><br><span class="line">        txtGwebtimemachinedemotable = new Text(shlDmp, SWT.BORDER);</span><br><span class="line">        txtGwebtimemachinedemotable.setBounds(102, 139, 210, 23);</span><br><span class="line">        </span><br><span class="line">        Combo combo = new Combo(shlDmp, SWT.NONE);</span><br><span class="line">        combo.setItems(new String[] &#123;&quot;TASKSHEET&quot;, &quot;ADMINISACOUNT&quot;, &quot;RECORDS&quot;&#125;);</span><br><span class="line">        combo.setBounds(102, 101, 131, 25);</span><br><span class="line">        </span><br><span class="line">        Button button = new Button(shlDmp, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if(txtFile.getText().trim().length()&gt;0 &amp;&amp; txtGwebtimemachinedemotable.getText().trim().length()&gt;0 &amp;&amp; combo.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        WTMbackstage.backupData(txtFile.getText().trim(),txtGwebtimemachinedemotable.getText().trim(),combo.getText().trim());</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;系统提示  导出成功&quot;);</span><br><span class="line">                        mb.setMessage(&quot;导出文件位置：&quot;+txtGwebtimemachinedemotable.getText().trim()+&quot;\\&quot;+txtFile.getText().trim());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (InterruptedException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-1101  导出失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (IOException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-1102  导出失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlDmp,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-1103  导出失败&quot;);</span><br><span class="line">                    mb.setMessage(&quot;文本框不能为空&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(153, 182, 80, 27);</span><br><span class="line">        button.setText(&quot;\u5BFC\u51FA&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_3 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_3.setImage(SWTResourceManager.getImage(OracleFileOut.class, &quot;/img/bg3_3.jpg&quot;));</span><br><span class="line">        label_3.setBounds(0, 237, 394, 34);</span><br><span class="line">        </span><br><span class="line">        Label label_4 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_4.setImage(SWTResourceManager.getImage(OracleFileOut.class, &quot;/img/bg3_4.jpg&quot;));</span><br><span class="line">        label_4.setBounds(0, 0, 394, 34);</span><br><span class="line">        </span><br><span class="line">        Button btnNewButton = new Button(shlDmp, SWT.NONE);</span><br><span class="line">        btnNewButton.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                DirectoryDialog dd=new DirectoryDialog(shlDmp);</span><br><span class="line">                dd.setText(&quot;目录浏览&quot;);  </span><br><span class="line">                dd.setMessage(&quot;请选择导出数据库文件存放的目录位置&quot;);  </span><br><span class="line">                dd.setFilterPath(&quot;C:\\&quot;);  </span><br><span class="line">                String locationPath = dd.open();  </span><br><span class="line">                if(locationPath!=null)&#123;                </span><br><span class="line">                    txtGwebtimemachinedemotable.setText(locationPath);  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btnNewButton.setBounds(318, 139, 60, 23);</span><br><span class="line">        btnNewButton.setText(&quot;\u6D4F\u89C8&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>OracleFileIn</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.FileDialog;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line"></span><br><span class="line">import java.io.IOException;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class OracleFileIn extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shlDmp;</span><br><span class="line">    private Text text_1;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public OracleFileIn(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        Display display = Display.getDefault();</span><br><span class="line">        createContents();</span><br><span class="line">        // 居中显示</span><br><span class="line">        int x = (display.getBounds().width - shlDmp.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shlDmp.getBounds().height) / 2;</span><br><span class="line">        shlDmp.setLocation(x, y);</span><br><span class="line">        </span><br><span class="line">        Button button = new Button(shlDmp, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                FileDialog fileDialog = new FileDialog(shlDmp);</span><br><span class="line">                String flag = fileDialog.open();</span><br><span class="line">                if(flag!=null) &#123;</span><br><span class="line">                    text_1.setText(fileDialog.getFilterPath()+&quot;\\&quot;+fileDialog.getFileName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(304, 92, 60, 23);</span><br><span class="line">        button.setText(&quot;\u6D4F\u89C8&quot;);</span><br><span class="line">        shlDmp.open();</span><br><span class="line">        shlDmp.layout();</span><br><span class="line">        //Display display = getParent().getDisplay();</span><br><span class="line">        while (!shlDmp.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shlDmp = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shlDmp.setSize(400, 300);</span><br><span class="line">        shlDmp.setText(&quot;DMP\u6587\u4EF6\u5BFC\u5165&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_1 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_1.setBounds(30, 95, 61, 17);</span><br><span class="line">        label_1.setText(&quot;\u5BFC\u5165\u8DEF\u5F84\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        text_1 = new Text(shlDmp, SWT.BORDER);</span><br><span class="line">        text_1.setBounds(97, 92, 200, 23);</span><br><span class="line">        </span><br><span class="line">        Button button = new Button(shlDmp, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                if(text_1.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        WTMbackstage.InputData(text_1.getText().trim());</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;系统提示  导入成功&quot;);</span><br><span class="line">                        mb.setMessage(&quot;导入文件位置：&quot;+text_1.getText().trim());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (InterruptedException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-1201  导入失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125; catch (IOException e1) &#123;</span><br><span class="line">                        MessageBox mb = new MessageBox(shlDmp,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                        mb.setText(&quot;WTM-1202  导入失败&quot;);</span><br><span class="line">                        mb.setMessage(e1.getMessage());</span><br><span class="line">                        mb.open();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlDmp,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-1203  导入失败&quot;);</span><br><span class="line">                    mb.setMessage(&quot;文本框不能为空&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(160, 147, 80, 27);</span><br><span class="line">        button.setText(&quot;\u5BFC\u5165&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label_3 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_3.setImage(SWTResourceManager.getImage(OracleFileIn.class, &quot;/img/bg3_3.jpg&quot;));</span><br><span class="line">        label_3.setBounds(0, 237, 394, 34);</span><br><span class="line">        </span><br><span class="line">        Label label_4 = new Label(shlDmp, SWT.NONE);</span><br><span class="line">        label_4.setImage(SWTResourceManager.getImage(OracleFileIn.class, &quot;/img/bg3_4.jpg&quot;));</span><br><span class="line">        label_4.setBounds(0, 0, 394, 34);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Modify</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.MessageBox;</span><br><span class="line"></span><br><span class="line">import java.sql.SQLException;</span><br><span class="line">import java.util.ArrayList;</span><br><span class="line">import java.util.List;</span><br><span class="line">import java.util.Map;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line"></span><br><span class="line">public class Modify extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shlAbout;</span><br><span class="line">    private Text id;</span><br><span class="line">    private Text name;</span><br><span class="line">    private Text resultfile;</span><br><span class="line">    private Text url;</span><br><span class="line">    private Map&lt;String, Object&gt; row;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public Modify(Shell parent, int style,Map&lt;String, Object&gt; row) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">        this.row = row;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        Display display = getParent().getDisplay();</span><br><span class="line">        int x = (display.getBounds().width - shlAbout.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shlAbout.getBounds().height) / 2;</span><br><span class="line">        shlAbout.setLocation(x, y);</span><br><span class="line">        shlAbout.open();</span><br><span class="line">        shlAbout.layout();</span><br><span class="line">        while (!shlAbout.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shlAbout = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shlAbout.setSize(300, 375);</span><br><span class="line">        shlAbout.setText(&quot;\u4FEE\u6539\u4EFB\u52A1&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        label.setBounds(57, 65, 36, 17);</span><br><span class="line">        label.setText(&quot;\u7F16\u53F7\uFF1A&quot;);</span><br><span class="line">        </span><br><span class="line">        id = new Text(shlAbout, SWT.BORDER);</span><br><span class="line">        id.setEnabled(false);</span><br><span class="line">        id.setBounds(109, 62, 130, 23);</span><br><span class="line">        </span><br><span class="line">        Label label_1 = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        label_1.setBounds(57, 107, 36, 17);</span><br><span class="line">        label_1.setText(&quot;\u540D\u79F0&quot;);</span><br><span class="line">        </span><br><span class="line">        name = new Text(shlAbout, SWT.BORDER);</span><br><span class="line">        name.setBounds(109, 104, 130, 23);</span><br><span class="line">        </span><br><span class="line">        Label label_2 = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        label_2.setBounds(57, 152, 36, 17);</span><br><span class="line">        label_2.setText(&quot;\u8DEF\u5F84&quot;);</span><br><span class="line">        </span><br><span class="line">        resultfile = new Text(shlAbout, SWT.BORDER);</span><br><span class="line">        resultfile.setBounds(109, 149, 130, 23);</span><br><span class="line">        </span><br><span class="line">        Label lblUrl = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        lblUrl.setBounds(57, 193, 36, 17);</span><br><span class="line">        lblUrl.setText(&quot;URL&quot;);</span><br><span class="line">        </span><br><span class="line">        url = new Text(shlAbout, SWT.BORDER);</span><br><span class="line">        url.setBounds(109, 190, 130, 23);</span><br><span class="line">        </span><br><span class="line">        Button btnNewButton = new Button(shlAbout, SWT.NONE);</span><br><span class="line">        btnNewButton.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                String sql = &quot; update tasksheet set TASKNAME=?,TASKRESULTFILE=?,TASKURLSTR=? where TASKID = &quot; + row.get(&quot;TASKID&quot;);</span><br><span class="line">                List&lt;String&gt; paramList = new ArrayList&lt;&gt;();</span><br><span class="line">                if(name.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    paramList.add(name.getText());</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlAbout,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0601  请填写名称&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请填写名称&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                if(resultfile.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    paramList.add(resultfile.getText());</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlAbout,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0602  请填写路径&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请填写路径&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                if(url.getText().trim().length()&gt;0) &#123;</span><br><span class="line">                    paramList.add(url.getText());</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlAbout,SWT.ICON_WARNING | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0603  请填写URL&quot;);</span><br><span class="line">                    mb.setMessage(&quot;请填写URL&quot;);</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                try &#123;</span><br><span class="line">                    WTMbackstage.update(sql, paramList.toArray());</span><br><span class="line">                &#125; catch (SQLException e1) &#123;</span><br><span class="line">                    MessageBox mb = new MessageBox(shlAbout,SWT.ICON_ERROR | SWT.OK);</span><br><span class="line">                    mb.setText(&quot;WTM-0604  数据库遇到错误&quot;);</span><br><span class="line">                    mb.setMessage(e1.getMessage());</span><br><span class="line">                    mb.open();</span><br><span class="line">                    return;</span><br><span class="line">                &#125;</span><br><span class="line">                MessageBox mb = new MessageBox(shlAbout,SWT.ICON_INFORMATION | SWT.OK);</span><br><span class="line">                mb.setText(&quot;系统提示&quot;);</span><br><span class="line">                mb.setMessage(&quot;修改成功&quot;);</span><br><span class="line">                mb.open();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btnNewButton.setBounds(57, 256, 80, 27);</span><br><span class="line">        btnNewButton.setText(&quot;\u4FDD\u5B58&quot;);</span><br><span class="line">        </span><br><span class="line">        Button button = new Button(shlAbout, SWT.NONE);</span><br><span class="line">        button.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                shlAbout.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        button.setBounds(159, 256, 80, 27);</span><br><span class="line">        button.setText(&quot;\u53D6\u6D88&quot;);</span><br><span class="line">        </span><br><span class="line">        id.setText(row.get(&quot;TASKID&quot;)+&quot;&quot;);</span><br><span class="line">        name.setText(row.get(&quot;TASKNAME&quot;)+&quot;&quot;);</span><br><span class="line">        resultfile.setText(row.get(&quot;TASKRESULTFILE&quot;)+&quot;&quot;);</span><br><span class="line">        url.setText(row.get(&quot;TASKURLSTR&quot;)+&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>HelpFile</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.swt.events.SelectionAdapter;</span><br><span class="line">import org.eclipse.swt.events.SelectionEvent;</span><br><span class="line">import org.eclipse.swt.widgets.Button;</span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Text;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class HelpFile extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shell;</span><br><span class="line">    private Text txtsearchEnginealtavistayahoogoogle;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public HelpFile(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        Display display = Display.getDefault();</span><br><span class="line">        createContents();</span><br><span class="line">        //居中显示</span><br><span class="line">        int x = (display.getBounds().width - shell.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shell.getBounds().height) / 2;</span><br><span class="line">        shell.setLocation(x, y);</span><br><span class="line">        shell.setLayout(null);</span><br><span class="line">        shell.open();</span><br><span class="line">        shell.layout();</span><br><span class="line">        while (!shell.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shell = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shell.setSize(450, 500);</span><br><span class="line">        shell.setText(&quot;\u7BA1\u7406\u5458\u4F7F\u7528\u624B\u518C&quot;);</span><br><span class="line">        </span><br><span class="line">        txtsearchEnginealtavistayahoogoogle = new Text(shell, SWT.BORDER | SWT.WRAP | SWT.V_SCROLL | SWT.READ_ONLY);</span><br><span class="line">        txtsearchEnginealtavistayahoogoogle.setBounds(10, 62, 424, 341);</span><br><span class="line">        txtsearchEnginealtavistayahoogoogle.setText(&quot;\u9996\u9875\r\n1\u3001\u767B\u5F55\u754C\u9762\uFF1A\u6B63\u786E\u8F93\u5165\u7BA1\u7406\u5458\u540D\u5B57\u548C\u5BC6\u7801\u70B9\u51FB\u767B\u5F55\u5373\u53EF\u8FDB\u5165WebTimeMachine\u4E3B\u754C\u9762\uFF1B\r\n2\u3001\u7CFB\u7EDF\u914D\u7F6E\uFF1A\u70B9\u51FB\u914D\u7F6E\u6587\u4EF6\u6309\u94AE\u5373\u53EF\u81EA\u52A8\u6253\u5F00\u5176\u6240\u5728\u7684\u6587\u4EF6\u5939\uFF0C\u65B9\u4FBF\u53CA\u65F6\u4FEE\u6539\uFF1B\r\n\r\n\u4E3B\u754C\u9762\r\n1\u3001\u5BFC\u822A\u680F\r\n    \uFF081\uFF09\u7CFB\u7EDF\uFF1A\u76F4\u63A5\u70B9\u51FB\u53EF\u6D4F\u89C8\u5E93\u76EE\u5F55\uFF1BDMP\u6587\u4EF6\u7684\u5BFC\u5165\u5BFC\u51FA\uFF1B\u5B89\u5168\u9000\u51FA\uFF1B\r\n    \uFF082\uFF09\u4E2A\u4EBA\uFF1A\u7BA1\u7406\u5458\u53EF\u5728\u4E2A\u4EBA\u4E2D\u5FC3\u4FEE\u6539\u5BC6\u7801\uFF1B\r\n    \uFF083\uFF09\u5E2E\u52A9\uFF1A\u53EF\u67E5\u770B\u4F7F\u7528\u624B\u518C\uFF0C\u65B9\u4FBF\u8BE5\u8F6F\u4EF6\u7684\u64CD\u4F5C\u4F7F\u7528\uFF1B\r\n    \uFF084\uFF09\u5173\u4E8E\uFF1A\u53EF\u67E5\u770B\u8BE5\u8F6F\u4EF6\u5F53\u524D\u7248\u672C\u4EE5\u53CA\u5176\u5F00\u53D1\u8005\uFF1B\r\n2\u3001\u4EFB\u52A1\u680F\r\n    \uFF081\uFF09\u4EFB\u52A1\u8868\uFF1A\u663E\u793A\u9700\u8981\u6267\u884C\u7684\u4EFB\u52A1\uFF0C\u5305\u62EC\uFF1A\u7F16\u53F7\u3001\u540D\u79F0\u3001\u8DEF\u5F84\u3001Url\u7B49\uFF1B\u53EF\u8F93\u5165\u540D\u79F0\u8FDB\u884C\u8BE6\u7EC6\u67E5\u8BE2\u4EFB\u52A1\uFF0C\u4E5F\u53EF\u76F4\u63A5\u67E5\u8BE2\u6240\u6709\u4EFB\u52A1\uFF1B\u53EF\u5BF9\u4EFB\u52A1\u8FDB\u884C\u589E\u3001\u5220\u3001\u6539\uFF1B\u53EF\u7ACB\u5373\u6267\u884C\u4E5F\u53EF\u5B9A\u65F6\u6267\u884C\uFF0C\u70B9\u51FB\u5B9A\u65F6\u6267\u884C\u8DF3\u8F6C\u5B9A\u65F6\u4EFB\u52A1\u754C\u9762\uFF1B\r\n    \uFF082\uFF09\u4EFB\u52A1\u8BA1\u5212\uFF1A\u6DFB\u52A0\u722C\u53D6\u4EFB\u52A1\uFF0C\u6240\u6DFB\u52A0\u7684\u4EFB\u52A1\u53EF\u5728\u4EFB\u52A1\u680F\u67E5\u770B\uFF1B\r\n    \uFF083\uFF09\u5B9A\u65F6\u4EFB\u52A1\uFF1A\u53EF\u9009\u62E9\u4E00\u4E2A\u65F6\u95F4\u6BB5\u6765\u5F00\u542F\u4EFB\u52A1\uFF0C\u6B64\u65F6\u4EFB\u52A1\u680F\u4E2D\u6240\u6709\u4EFB\u52A1\u5C06\u4F1A\u5728\u8BE5\u65F6\u95F4\u6BB5\u81EA\u52A8\u8FDB\u884C\u722C\u53D6\u5E76\u4FDD\u5B58\u5728\u6587\u4EF6\u5939\u4E2D\uFF1B\r\n    \uFF084\uFF09\u722C\u53D6\u8BB0\u5F55\uFF1A\u5206\u9875\u663E\u793A\u722C\u53D6\u7684\u5386\u53F2\u8BB0\u5F55\uFF0C\u5305\u62EC\uFF1A\u8BB0\u5F55\u7F16\u53F7\u3001\u722C\u53D6\u65F6\u95F4\u3001\u722C\u53D6\u72B6\u6001\u3001\u4EFB\u52A1\u7F16\u53F7\u3001\u540D\u79F0\u3001\u8DEF\u5F84\u3001Url\u7B49\uFF1B\u53EF\u5BF9\u722C\u53D6\u8BB0\u5F55\u4ECE\u540D\u79F0\u3001Url\u3001\u4EFB\u52A1\u7F16\u53F7\u3001\u722C\u53D6\u72B6\u6001\u4EE5\u53CA\u722C\u53BB\u65F6\u95F4\u7B49\u65B9\u9762\u8FDB\u884C\u6A21\u7CCA\u3001\u7CBE\u786E\u67E5\u8BE2\uFF1B\r\n&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shell, SWT.CENTER);</span><br><span class="line">        label.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 12, SWT.NORMAL));</span><br><span class="line">        label.setBounds(164, 21, 112, 25);</span><br><span class="line">        label.setText(&quot;\u7BA1\u7406\u5458\u4F7F\u7528\u624B\u518C&quot;);</span><br><span class="line">        </span><br><span class="line">        Button btnNewButton = new Button(shell, SWT.CENTER);</span><br><span class="line">        btnNewButton.setBounds(143, 423, 158, 30);</span><br><span class="line">        btnNewButton.addSelectionListener(new SelectionAdapter() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void widgetSelected(SelectionEvent e) &#123;</span><br><span class="line">                shell.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        btnNewButton.setText(&quot;\u5173\u95ED&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>About</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">package org.wtm.demo;</span><br><span class="line"></span><br><span class="line">import org.eclipse.swt.widgets.Dialog;</span><br><span class="line">import org.eclipse.swt.widgets.Display;</span><br><span class="line">import org.eclipse.swt.widgets.Shell;</span><br><span class="line">import org.eclipse.swt.widgets.Label;</span><br><span class="line">import org.eclipse.swt.SWT;</span><br><span class="line">import org.eclipse.wb.swt.SWTResourceManager;</span><br><span class="line"></span><br><span class="line">public class About extends Dialog &#123;</span><br><span class="line"></span><br><span class="line">    protected Object result;</span><br><span class="line">    protected Shell shlAbout;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create the dialog.</span><br><span class="line">     * @param parent</span><br><span class="line">     * @param style</span><br><span class="line">     */</span><br><span class="line">    public About(Shell parent, int style) &#123;</span><br><span class="line">        super(parent, style);</span><br><span class="line">        setText(&quot;SWT Dialog&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Open the dialog.</span><br><span class="line">     * @return the result</span><br><span class="line">     */</span><br><span class="line">    public Object open() &#123;</span><br><span class="line">        createContents();</span><br><span class="line">        Display display = getParent().getDisplay();</span><br><span class="line">        int x = (display.getBounds().width - shlAbout.getBounds().width) / 2;</span><br><span class="line">        int y = (display.getBounds().height - shlAbout.getBounds().height) / 2;</span><br><span class="line">        shlAbout.setLocation(x, y);</span><br><span class="line">        shlAbout.open();</span><br><span class="line">        shlAbout.layout();</span><br><span class="line">        while (!shlAbout.isDisposed()) &#123;</span><br><span class="line">            if (!display.readAndDispatch()) &#123;</span><br><span class="line">                display.sleep();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Create contents of the dialog.</span><br><span class="line">     */</span><br><span class="line">    private void createContents() &#123;</span><br><span class="line">        shlAbout = new Shell(getParent(), SWT.DIALOG_TRIM | SWT.PRIMARY_MODAL);</span><br><span class="line">        shlAbout.setSize(450, 300);</span><br><span class="line">        shlAbout.setText(&quot;About&quot;);</span><br><span class="line">        </span><br><span class="line">        Label lblAbout = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        lblAbout.setFont(SWTResourceManager.getFont(&quot;Microsoft YaHei UI&quot;, 14, SWT.NORMAL));</span><br><span class="line">        lblAbout.setBounds(192, 12, 56, 25);</span><br><span class="line">        lblAbout.setText(&quot;About&quot;);</span><br><span class="line">        </span><br><span class="line">        Label label = new Label(shlAbout, SWT.SEPARATOR | SWT.HORIZONTAL);</span><br><span class="line">        label.setBounds(10, 43, 424, 2);</span><br><span class="line">        </span><br><span class="line">        Label lblWebtimemoine = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        lblWebtimemoine.setBounds(47, 64, 104, 17);</span><br><span class="line">        lblWebtimemoine.setText(&quot;WebTimeMachine&quot;);</span><br><span class="line">        </span><br><span class="line">        Label lblNewLabel = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        lblNewLabel.setBounds(47, 87, 104, 17);</span><br><span class="line">        lblNewLabel.setText(&quot;Version 3.2&quot;);</span><br><span class="line">        </span><br><span class="line">        Label lblHooyantsingChuangweirong = new Label(shlAbout, SWT.NONE);</span><br><span class="line">        lblHooyantsingChuangweirong.setBounds(47, 110, 181, 34);</span><br><span class="line">        lblHooyantsingChuangweirong.setText(&quot;Hooyantsing Chuangwei-Rong\r\nLida-Xiao Ziyun-Shao&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>数据库脚本</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">create table Tasksheet(</span><br><span class="line">       taskid number(6) primary key,</span><br><span class="line">       taskname varchar2(40),</span><br><span class="line">       taskresultfile varchar2(60),</span><br><span class="line">       taskcachefile varchar2(60),</span><br><span class="line">       taskurlstr varchar2(600) unique</span><br><span class="line">);</span><br><span class="line">create sequence Seq_tasksheet_taskid ;</span><br><span class="line"></span><br><span class="line">create table AdminisAcount(</span><br><span class="line">       Adid number(4)primary key,</span><br><span class="line">       Adname varchar2(10),</span><br><span class="line">       Adpassword varchar(20),</span><br><span class="line">       Adcontact varchar2(11)  not null,</span><br><span class="line">       Ademail varchar2(100) constraint ck_adm_email check (Ademail like &#x27;_%@_%._%&#x27;),</span><br><span class="line">       Adtime date</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">create sequence Ad_table start with 1001 increment by 1;</span><br><span class="line"></span><br><span class="line">insert into AdminisAcount values(Ad_table.Nextval,&#x27;胡燕卿&#x27;,&#x27;123456&#x27;,&#x27;123&#x27;,&#x27;1111@qq.com&#x27;,sysdate);</span><br><span class="line">insert into AdminisAcount values(Ad_table.Nextval,&#x27;容创伟&#x27;,&#x27;123456&#x27;,&#x27;123456&#x27;,&#x27;2222@qq.com&#x27;,sysdate);</span><br><span class="line">insert into AdminisAcount values(Ad_table.Nextval,&#x27;肖理达&#x27;,&#x27;123456&#x27;,&#x27;123456&#x27;,&#x27;123@qq.com&#x27;,sysdate);</span><br><span class="line">insert into AdminisAcount values(Ad_table.Nextval,&#x27;邵子芸&#x27;,&#x27;123456&#x27;,&#x27;123456&#x27;,&#x27;4444@qq.com&#x27;,sysdate);</span><br><span class="line"></span><br><span class="line">create table records(</span><br><span class="line">      recno int primary key, --记录编号，主键，序列生成</span><br><span class="line">      time date,        --爬取时间，调用数据库时间</span><br><span class="line">      success varchar2(6) constraint ck_rec_succ check(success in(&#x27;true&#x27;,&#x27;false&#x27;)), --爬取状态，约束为字符串true/false</span><br><span class="line">      taskid int ,  --任务编号</span><br><span class="line">      taskresultfile varchar2(60),   --爬取文件路径</span><br><span class="line">      webname varchar2(60),         --网站名称</span><br><span class="line">      url varchar2(600),            --url</span><br><span class="line">      cache varchar2(60)    --缓存文件，暂定null</span><br><span class="line">)                      </span><br><span class="line">create sequence seq_rec_no          --创建主键序列</span><br><span class="line"></span><br><span class="line">select * from tasksheet;</span><br><span class="line">select * from AdminisAcount;</span><br></pre></td></tr></table></figure>

<p><strong>项目工程</strong></p>
<p><strong>WTM 3.2</strong></p>
<p>**<a href="./file/Demo.zip">Demo.zip</a></p>
<p>**</p>


<div class="article-footer reveal fs14"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p>
</div></section></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="header cap theme"><span>接下来阅读</span></section><section class="body fs14"><a id="next" href="/%E6%8A%80%E6%9C%AF%E5%90%91/Java/%E6%BA%90%E8%BE%B0%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95/%E7%AC%AC50%E6%AC%A1%E8%AF%BE%E7%A8%8B/">第50次课程<span class="note">较早</span></a><div class="line"></div><a id="prev" href="/%E6%8A%80%E6%9C%AF%E5%90%91/Java/%E6%BA%90%E8%BE%B0%E8%AF%BE%E7%A8%8B%E8%AE%B0%E5%BD%95/%E7%AC%AC51%E6%AC%A1%E8%AF%BE%E7%A8%8B/">第51次课程<span class="note">较新</span></a></section></div>








      
<footer class="page-footer reveal fs12"><hr><div class="text"><p>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
<p>本站由 <a href="http://blog.hooy.xyz/">@Hooyantsing</a> 创建，使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.7.0" title="v1.7.0">Stellar</a> 作为主题。</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    <script type="text/javascript">
  stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.7.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js',
    sitesjs: '/js/plugins/sites.js',
    friendsjs: '/js/plugins/friends.js',
  };

  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.3.1/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@6/swiper-bundle.min.css","js":"https://unpkg.com/swiper@6/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://cdn.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://cdn.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".swiper-slide img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti/umd/heti.min.css","js":"https://unpkg.com/heti/umd/heti-addon.min.js"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->



<!-- inject -->


  </div>
</body>
</html>
